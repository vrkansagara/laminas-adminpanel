"undefined"==typeof MochiKit&&(MochiKit={}),void 0===MochiKit.MochiKit&&(MochiKit.MochiKit={}),MochiKit.MochiKit.NAME="MochiKit.MochiKit",MochiKit.MochiKit.VERSION="1.4.2",MochiKit.MochiKit.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.MochiKit.toString=function(){return this.__repr__()},MochiKit.MochiKit.SUBMODULES=["Base","Iter","Logging","DateTime","Format","Async","DOM","Selector","Style","LoggingPane","Color","Signal","Position","Visual","DragAndDrop","Sortable"],"undefined"!=typeof JSAN||"undefined"!=typeof dojo?("undefined"!=typeof dojo&&(dojo.provide("MochiKit.MochiKit"),function(t){for(var e=0;e<t.length;e++)dojo.require("MochiKit."+t[e])}(MochiKit.MochiKit.SUBMODULES)),"undefined"!=typeof JSAN&&function(t){for(var e=0;e<t.length;e++)JSAN.use("MochiKit."+t[e],[])}(MochiKit.MochiKit.SUBMODULES),function(){var t,e,i,n,o=MochiKit.Base.extend,r=MochiKit.MochiKit,s=r.SUBMODULES,a=[],l=[],c={};for(t=0;t<s.length;t++){for(e in o(a,(i=MochiKit[s[t]]).EXPORT),o(l,i.EXPORT_OK),i.EXPORT_TAGS)c[e]=o(c[e],i.EXPORT_TAGS[e]);var h;for(n=(n=i.EXPORT_TAGS[":all"])||o(null,i.EXPORT,i.EXPORT_OK),h=0;h<n.length;h++)r[e=n[h]]=i[e]}r.EXPORT=a,r.EXPORT_OK=l,r.EXPORT_TAGS=c}()):(void 0===MochiKit.__compat__&&(MochiKit.__compat__=!0),function(){if("undefined"!=typeof document){var t,e=document.getElementsByTagName("script"),i="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xlink",o=null,r=null,s={};for(l=0;l<e.length;l++){switch(t=null,e[l].namespaceURI){case i:t=e[l].getAttributeNS(n,"href");break;default:t=e[l].getAttribute("src")}t&&(s[t]=!0,t.match(/MochiKit.js(\?.*)?$/)&&(o=t.substring(0,t.lastIndexOf("MochiKit.js")),r=e[l]))}if(null!==o)for(var a=MochiKit.MochiKit.SUBMODULES,l=0;l<a.length;l++)if(!MochiKit[a[l]]){var c=o+a[l]+".js";if(!(c in s))if(r.namespaceURI==i||"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"==r.namespaceURI){var h=document.createElementNS(r.namespaceURI,"script");h.setAttribute("id","MochiKit_"+o+a[l]),r.namespaceURI==i?h.setAttributeNS(n,"href",c):h.setAttribute("src",c),h.setAttribute("type","application/x-javascript"),r.parentNode.appendChild(h)}else document.write("<"+r.nodeName+' src="'+c+'" type="text/javascript"><\/script>')}}}()),"undefined"!=typeof dojo&&dojo.provide("MochiKit.Base"),"undefined"==typeof MochiKit&&(MochiKit={}),void 0===MochiKit.Base&&(MochiKit.Base={}),void 0===MochiKit.__export__&&(MochiKit.__export__=MochiKit.__compat__||"undefined"==typeof JSAN&&"undefined"==typeof dojo),MochiKit.Base.VERSION="1.4.2",MochiKit.Base.NAME="MochiKit.Base",MochiKit.Base.update=function(t,e){null==t&&(t={});for(var i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)t[o]=n[o]}return t},MochiKit.Base.update(MochiKit.Base,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},camelize:function(t){for(var e=t.split("-"),i=e[0],n=1;n<e.length;n++)i+=e[n].charAt(0).toUpperCase()+e[n].substring(1);return i},counter:function(t){return 0===arguments.length&&(t=1),function(){return t++}},clone:function(t){var e=arguments.callee;if(1==arguments.length)return e.prototype=t,new e},_deps:function(t,e){t in MochiKit||(MochiKit[t]={}),"undefined"!=typeof dojo&&dojo.provide("MochiKit."+t);for(var i=0;i<e.length;i++)if("undefined"!=typeof dojo&&dojo.require("MochiKit."+e[i]),"undefined"!=typeof JSAN&&JSAN.use("MochiKit."+e[i],[]),!(e[i]in MochiKit))throw"MochiKit."+t+" depends on MochiKit."+e[i]+"!"},_flattenArray:function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n instanceof Array?arguments.callee(t,n):t.push(n)}return t},flattenArray:function(t){return MochiKit.Base._flattenArray([],t)},flattenArguments:function(t){for(var e=[],i=MochiKit.Base.extend(null,arguments);i.length;){var n=i.shift();if(n&&"object"==typeof n&&"number"==typeof n.length)for(var o=n.length-1;0<=o;o--)i.unshift(n[o]);else e.push(n)}return e},extend:function(t,e,i){if(i=i||0,e){var n=e.length;if("number"!=typeof n){if(void 0===MochiKit.Iter)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");n=(e=MochiKit.Iter.list(e)).length}t=t||[];for(var o=i;o<n;o++)t.push(e[o])}return t},updatetree:function(t,e){null==t&&(t={});for(var i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n){var r=n[o];"object"==typeof t[o]&&"object"==typeof r?arguments.callee(t[o],r):t[o]=r}}return t},setdefault:function(t,e){null==t&&(t={});for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var o in n)o in t||(t[o]=n[o])}return t},keys:function(t){var e=[];for(var i in t)e.push(i);return e},values:function(t){var e=[];for(var i in t)e.push(t[i]);return e},items:function(t){var e=[];for(var i in t){var n;try{n=t[i]}catch(t){continue}e.push([i,n])}return e},_newNamedError:function(t,e,i){i.prototype=new MochiKit.Base.NamedError(t.NAME+"."+e),t[e]=i},operator:{truth:function(t){return!!t},lognot:function(t){return!t},identity:function(t){return t},not:function(t){return~t},neg:function(t){return-t},add:function(t,e){return t+e},sub:function(t,e){return t-e},div:function(t,e){return t/e},mod:function(t,e){return t%e},mul:function(t,e){return t*e},and:function(t,e){return t&e},or:function(t,e){return t|e},xor:function(t,e){return t^e},lshift:function(t,e){return t<<e},rshift:function(t,e){return t>>e},zrshift:function(t,e){return t>>>e},eq:function(t,e){return t==e},ne:function(t,e){return t!=e},gt:function(t,e){return e<t},ge:function(t,e){return e<=t},lt:function(t,e){return t<e},le:function(t,e){return t<=e},seq:function(t,e){return t===e},sne:function(t,e){return t!==e},ceq:function(t,e){return 0===MochiKit.Base.compare(t,e)},cne:function(t,e){return 0!==MochiKit.Base.compare(t,e)},cgt:function(t,e){return 1==MochiKit.Base.compare(t,e)},cge:function(t,e){return-1!=MochiKit.Base.compare(t,e)},clt:function(t,e){return-1==MochiKit.Base.compare(t,e)},cle:function(t,e){return 1!=MochiKit.Base.compare(t,e)},logand:function(t,e){return t&&e},logor:function(t,e){return t||e},contains:function(t,e){return e in t}},forwardCall:function(t){return function(){return this[t].apply(this,arguments)}},itemgetter:function(e){return function(t){return t[e]}},typeMatcher:function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];e[i]=i}return function(){for(var t=0;t<arguments.length;t++)if(!(typeof arguments[t]in e))return!1;return!0}},isNull:function(){for(var t=0;t<arguments.length;t++)if(null!==arguments[t])return!1;return!0},isUndefinedOrNull:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if(null!=e)return!1}return!0},isEmpty:function(t){return!MochiKit.Base.isNotEmpty.apply(this,arguments)},isNotEmpty:function(t){for(var e=0;e<arguments.length;e++){var i=arguments[e];if(!i||!i.length)return!1}return!0},isArrayLike:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t],i=typeof e;if("object"!=i&&("function"!=i||"function"!=typeof e.item)||null===e||"number"!=typeof e.length||3===e.nodeType||4===e.nodeType)return!1}return!0},isDateLike:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if("object"!=typeof e||null===e||"function"!=typeof e.getTime)return!1}return!0},xmap:function(t){if(null===t)return MochiKit.Base.extend(null,arguments,1);for(var e=[],i=1;i<arguments.length;i++)e.push(t(arguments[i]));return e},map:function(t,e){var i=MochiKit.Base,n=MochiKit.Iter,o=i.isArrayLike;if(arguments.length<=2){if(!o(e)){if(!n)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");if(e=n.list(e),null===t)return e}if(null===t)return i.extend(null,e);for(var r=[],s=0;s<e.length;s++)r.push(t(e[s]));return r}null===t&&(t=Array);var a=null;for(s=1;s<arguments.length;s++){if(!o(arguments[s])){if(n)return n.list(n.imap.apply(null,arguments));throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}var l=arguments[s].length;(null===a||l<a)&&(a=l)}for(r=[],s=0;s<a;s++){for(var c=[],h=1;h<arguments.length;h++)c.push(arguments[h][s]);r.push(t.apply(this,c))}return r},xfilter:function(t){var e=[];null===t&&(t=MochiKit.Base.operator.truth);for(var i=1;i<arguments.length;i++){var n=arguments[i];t(n)&&e.push(n)}return e},filter:function(t,e,i){var n=[],o=MochiKit.Base;if(!o.isArrayLike(e)){if(!MochiKit.Iter)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");e=MochiKit.Iter.list(e)}if(null===t&&(t=o.operator.truth),"function"==typeof Array.prototype.filter)return Array.prototype.filter.call(e,t,i);if(null==i)for(var r=0;r<e.length;r++){var s=e[r];t(s)&&n.push(s)}else for(r=0;r<e.length;r++)s=e[r],t.call(i,s)&&n.push(s);return n},_wrapDumbFunction:function(func){return function(){switch(arguments.length){case 0:return func();case 1:return func(arguments[0]);case 2:return func(arguments[0],arguments[1]);case 3:return func(arguments[0],arguments[1],arguments[2])}for(var args=[],i=0;i<arguments.length;i++)args.push("arguments["+i+"]");return eval("(func("+args.join(",")+"))")}},methodcaller:function(e){var i=MochiKit.Base.extend(null,arguments,1);return"function"==typeof e?function(t){return e.apply(t,i)}:function(t){return t[e].apply(t,i)}},method:function(t,e){var i=MochiKit.Base;return i.bind.apply(this,i.extend([e,t],arguments,2))},compose:function(t,e){var i=[],n=MochiKit.Base;if(0===arguments.length)throw new TypeError("compose() requires at least one argument");for(var o=0;o<arguments.length;o++){var r=arguments[o];if("function"!=typeof r)throw new TypeError(n.repr(r)+" is not a function");i.push(r)}return function(){for(var t=arguments,e=i.length-1;0<=e;e--)t=[i[e].apply(this,t)];return t[0]}},bind:function(t,e){"string"==typeof t&&(t=e[t]);var i=t.im_func,n=t.im_preargs,o=t.im_self,r=MochiKit.Base;"function"==typeof t&&void 0===t.apply&&(t=r._wrapDumbFunction(t)),"function"!=typeof i&&(i=t),void 0!==e&&(o=e),n=void 0===n?[]:n.slice(),r.extend(n,arguments,2);function s(){var t=arguments,e=arguments.callee;0<e.im_preargs.length&&(t=r.concat(e.im_preargs,t));var i=e.im_self;return i=i||this,e.im_func.apply(i,t)}return s.im_self=o,s.im_func=i,s.im_preargs=n,s},bindLate:function(t,e){var n=MochiKit.Base;if("string"!=typeof t)return n.bind.apply(this,arguments);function i(){var t=arguments,e=arguments.callee;0<e.im_preargs.length&&(t=n.concat(e.im_preargs,t));var i=e.im_self;return(i=i||this)[e.im_func].apply(i,t)}var o=n.extend([],arguments,2);return i.im_self=e,i.im_func=t,i.im_preargs=o,i},bindMethods:function(t){var e=MochiKit.Base.bind;for(var i in t){var n=t[i];"function"==typeof n&&(t[i]=e(n,t))}},registerComparator:function(t,e,i,n){MochiKit.Base.comparatorRegistry.register(t,e,i,n)},_primitives:{boolean:!0,string:!0,number:!0},compare:function(t,e){if(t==e)return 0;var i=null==t,n=null==e;if(i&&n)return 0;if(i)return-1;if(n)return 1;var o=MochiKit.Base,r=o._primitives;if(!(typeof t in r&&typeof e in r))try{return o.comparatorRegistry.match(t,e)}catch(t){if(t!=o.NotFound)throw t}if(t<e)return-1;if(e<t)return 1;var s=o.repr;throw new TypeError(s(t)+" and "+s(e)+" can not be compared")},compareDateLike:function(t,e){return MochiKit.Base.compare(t.getTime(),e.getTime())},compareArrayLike:function(t,e){var i=MochiKit.Base.compare,n=t.length,o=0;n>e.length?(o=1,n=e.length):n<e.length&&(o=-1);for(var r=0;r<n;r++){var s=i(t[r],e[r]);if(s)return s}return o},registerRepr:function(t,e,i,n){MochiKit.Base.reprRegistry.register(t,e,i,n)},repr:function(e){if(void 0===e)return"undefined";if(null===e)return"null";try{return"function"==typeof e.__repr__?e.__repr__():"function"==typeof e.repr&&e.repr!=arguments.callee?e.repr():MochiKit.Base.reprRegistry.match(e)}catch(t){if("string"==typeof e.NAME&&(e.toString==Function.prototype.toString||e.toString==Object.prototype.toString))return e.NAME}try{var t=e+""}catch(t){return"["+typeof e+"]"}if("function"==typeof e){var i=(t=(t=t.replace(/^\s+/,"").replace(/\s+/g," ")).replace(/,(\S)/,", $1")).indexOf("{");-1!=i&&(t=t.substr(0,i)+"{...}")}return t},reprArrayLike:function(t){var e=MochiKit.Base;return"["+e.map(e.repr,t).join(", ")+"]"},reprString:function(t){return('"'+t.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\v]/g,"\\v").replace(/[\r]/g,"\\r")},reprNumber:function(t){return t+""},registerJSON:function(t,e,i,n){MochiKit.Base.jsonRegistry.register(t,e,i,n)},evalJSON:function(){return eval("("+MochiKit.Base._filterJSON(arguments[0])+")")},_filterJSON:function(t){var e=t.match(/^\s*\/\*(.*)\*\/\s*$/);return e?e[1]:t},serializeJSON:function(t){var e=typeof t;if("number"==e||"boolean"==e)return t+"";if(null===t)return"null";if("string"==e){for(var i="",n=0;n<t.length;n++){var o=t.charAt(n);if('"'==o)i+='\\"';else if("\\"==o)i+="\\\\";else if("\b"==o)i+="\\b";else if("\f"==o)i+="\\f";else if("\n"==o)i+="\\n";else if("\r"==o)i+="\\r";else if("\t"==o)i+="\\t";else if(t.charCodeAt(n)<=31){var r=t.charCodeAt(n).toString(16);r.length<2&&(r="0"+r),i+="\\u00"+r.toUpperCase()}else i+=o}return'"'+i+'"'}var s,a=arguments.callee;if("function"==typeof t.__json__&&(s=t.__json__(),t!==s))return a(s);if("function"==typeof t.json&&(s=t.json(),t!==s))return a(s);if("function"!=e&&"number"==typeof t.length){for(i=[],n=0;n<t.length;n++){var l=a(t[n]);"string"==typeof l&&i.push(l)}return"["+i.join(", ")+"]"}var c=MochiKit.Base;try{if(t!==(s=c.jsonRegistry.match(t)))return a(s)}catch(t){if(t!=c.NotFound)throw t}if("undefined"==e)throw new TypeError("undefined can not be serialized as JSON");if("function"==e)return null;for(var h in i=[],t){var u;if("number"==typeof h)u='"'+h+'"';else{if("string"!=typeof h)continue;u=a(h)}"string"==typeof(l=a(t[h]))&&i.push(u+":"+l)}return"{"+i.join(", ")+"}"},objEqual:function(t,e){return 0===MochiKit.Base.compare(t,e)},arrayEqual:function(t,e){return t.length==e.length&&0===MochiKit.Base.compare(t,e)},concat:function(){for(var t=[],e=MochiKit.Base.extend,i=0;i<arguments.length;i++)e(t,arguments[i]);return t},keyComparator:function(i){var t=MochiKit.Base,r=t.compare;if(1==arguments.length)return function(t,e){return r(t[i],e[i])};var s=t.extend(null,arguments);return function(t,e){for(var i=0,n=0;0===i&&n<s.length;n++){var o=s[n];i=r(t[o],e[o])}return i}},reverseKeyComparator:function(t){var i=MochiKit.Base.keyComparator.apply(this,arguments);return function(t,e){return i(e,t)}},partial:function(t){var e=MochiKit.Base;return e.bind.apply(this,e.extend([t,void 0],arguments,1))},listMinMax:function(t,e){if(0===e.length)return null;for(var i=e[0],n=MochiKit.Base.compare,o=1;o<e.length;o++){var r=e[o];n(r,i)==t&&(i=r)}return i},objMax:function(){return MochiKit.Base.listMinMax(1,arguments)},objMin:function(){return MochiKit.Base.listMinMax(-1,arguments)},findIdentical:function(t,e,i,n){null==n&&(n=t.length),null==i&&(i=0);for(var o=i;o<n;o++)if(t[o]===e)return o;return-1},mean:function(){for(var t=0,e=MochiKit.Base.extend(null,arguments),i=e.length;e.length;){var n=e.shift();if(n&&"object"==typeof n&&"number"==typeof n.length){i+=n.length-1;for(var o=n.length-1;0<=o;o--)t+=n[o]}else t+=n}if(i<=0)throw new TypeError("mean() requires at least one argument");return t/i},median:function(){var t=MochiKit.Base.flattenArguments(arguments);if(0===t.length)throw new TypeError("median() requires at least one argument");if(t.sort(compare),t.length%2!=0)return t[(t.length-1)/2];var e=t.length/2;return(t[e]+t[e-1])/2},findValue:function(t,e,i,n){null==n&&(n=t.length),null==i&&(i=0);for(var o=MochiKit.Base.compare,r=i;r<n;r++)if(0===o(t[r],e))return r;return-1},nodeWalk:function(t,e){for(var i=[t],n=MochiKit.Base.extend;i.length;){var o=e(i.shift());o&&n(i,o)}},nameFunctions:function(t){var e=t.NAME;for(var i in void 0===e?e="":e+=".",t){var n=t[i];if("function"==typeof n&&void 0===n.NAME)try{n.NAME=e+i}catch(t){}}},queryString:function(t,e){if(void 0!==MochiKit.DOM&&1==arguments.length&&("string"==typeof t||void 0!==t.nodeType&&0<t.nodeType)){var i=MochiKit.DOM.formContents(t);t=i[0],e=i[1]}else if(1==arguments.length){if("number"==typeof t.length&&2==t.length)return arguments.callee(t[0],t[1]);var n=t;for(var o in t=[],e=[],n){var r=n[o];if("function"!=typeof r)if(MochiKit.Base.isArrayLike(r))for(var s=0;s<r.length;s++)t.push(o),e.push(r[s]);else t.push(o),e.push(r)}}var a=[],l=Math.min(t.length,e.length),c=MochiKit.Base.urlEncode;for(s=0;s<l;s++)null!=(r=e[s])&&a.push(c(t[s])+"="+c(r));return a.join("&")},parseQueryString:function(t,e){var i,n=("?"==t.charAt(0)?t.substring(1):t).replace(/\+/g,"%20").split(/\&amp\;|\&\#38\;|\&#x26;|\&/),o={};if(i="undefined"!=typeof decodeURIComponent?decodeURIComponent:unescape,e)for(var r=0;r<n.length;r++){var s=n[r].split("=");if(l=i(s.shift())){var a=o[l];a instanceof Array||(a=[],o[l]=a),a.push(i(s.join("=")))}}else for(r=0;r<n.length;r++){var l;(l=(s=n[r].split("=")).shift())&&(o[i(l)]=i(s.join("=")))}return o}}),MochiKit.Base.AdapterRegistry=function(){this.pairs=[]},MochiKit.Base.AdapterRegistry.prototype={register:function(t,e,i,n){n?this.pairs.unshift([t,e,i]):this.pairs.push([t,e,i])},match:function(){for(var t=0;t<this.pairs.length;t++){var e=this.pairs[t];if(e[1].apply(this,arguments))return e[2].apply(this,arguments)}throw MochiKit.Base.NotFound},unregister:function(t){for(var e=0;e<this.pairs.length;e++){if(this.pairs[e][0]==t)return this.pairs.splice(e,1),!0}return!1}},MochiKit.Base.EXPORT=["flattenArray","noop","camelize","counter","clone","extend","update","updatetree","setdefault","keys","values","items","NamedError","operator","forwardCall","itemgetter","typeMatcher","isCallable","isUndefined","isUndefinedOrNull","isNull","isEmpty","isNotEmpty","isArrayLike","isDateLike","xmap","map","xfilter","filter","methodcaller","compose","bind","bindLate","bindMethods","NotFound","AdapterRegistry","registerComparator","compare","registerRepr","repr","objEqual","arrayEqual","concat","keyComparator","reverseKeyComparator","partial","merge","listMinMax","listMax","listMin","objMax","objMin","nodeWalk","zip","urlEncode","queryString","serializeJSON","registerJSON","evalJSON","parseQueryString","findValue","findIdentical","flattenArguments","method","average","mean","median"],MochiKit.Base.EXPORT_OK=["nameFunctions","comparatorRegistry","reprRegistry","jsonRegistry","compareDateLike","compareArrayLike","reprArrayLike","reprString","reprNumber"],MochiKit.Base._exportSymbols=function(t,e){if(MochiKit.__export__)for(var i=e.EXPORT_TAGS[":all"],n=0;n<i.length;n++)t[i[n]]=e[i[n]]},MochiKit.Base.__new__=function(){var t=this;t.noop=t.operator.identity,t.forward=t.forwardCall,t.find=t.findValue,"undefined"!=typeof encodeURIComponent?t.urlEncode=function(t){return encodeURIComponent(t).replace(/\'/g,"%27")}:t.urlEncode=function(t){return escape(t).replace(/\+/g,"%2B").replace(/\"/g,"%22").rval.replace(/\'/g,"%27")},t.NamedError=function(t){this.message=t,this.name=t},t.NamedError.prototype=new Error,t.update(t.NamedError.prototype,{repr:function(){return this.message&&this.message!=this.name?this.name+"("+t.repr(this.message)+")":this.name+"()"},toString:t.forwardCall("repr")}),t.NotFound=new t.NamedError("MochiKit.Base.NotFound"),t.listMax=t.partial(t.listMinMax,1),t.listMin=t.partial(t.listMinMax,-1),t.isCallable=t.typeMatcher("function"),t.isUndefined=t.typeMatcher("undefined"),t.merge=t.partial(t.update,null),t.zip=t.partial(t.map,null),t.average=t.mean,t.comparatorRegistry=new t.AdapterRegistry,t.registerComparator("dateLike",t.isDateLike,t.compareDateLike),t.registerComparator("arrayLike",t.isArrayLike,t.compareArrayLike),t.reprRegistry=new t.AdapterRegistry,t.registerRepr("arrayLike",t.isArrayLike,t.reprArrayLike),t.registerRepr("string",t.typeMatcher("string"),t.reprString),t.registerRepr("numbers",t.typeMatcher("number","boolean"),t.reprNumber),t.jsonRegistry=new t.AdapterRegistry;var e=t.concat(t.EXPORT,t.EXPORT_OK);t.EXPORT_TAGS={":common":t.concat(t.EXPORT_OK),":all":e},t.nameFunctions(this)},MochiKit.Base.__new__(),MochiKit.__export__&&(compare=MochiKit.Base.compare,compose=MochiKit.Base.compose,serializeJSON=MochiKit.Base.serializeJSON,mean=MochiKit.Base.mean,median=MochiKit.Base.median),MochiKit.Base._exportSymbols(this,MochiKit.Base),MochiKit.Base._deps("Iter",["Base"]),MochiKit.Iter.NAME="MochiKit.Iter",MochiKit.Iter.VERSION="1.4.2",MochiKit.Base.update(MochiKit.Iter,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},registerIteratorFactory:function(t,e,i,n){MochiKit.Iter.iteratorRegistry.register(t,e,i,n)},isIterable:function(t){return null!=t&&("function"==typeof t.next||"function"==typeof t.iter)},iter:function(e,i){var t=MochiKit.Iter;if(2==arguments.length)return t.takewhile(function(t){return t!=i},e);if("function"==typeof e.next)return e;if("function"==typeof e.iter)return e.iter();try{return t.iteratorRegistry.match(e)}catch(t){var n=MochiKit.Base;throw t==n.NotFound&&(t=new TypeError(typeof e+": "+n.repr(e)+" is not iterable")),t}},count:function(t){t=t||0;var e=MochiKit.Base;return{repr:function(){return"count("+t+")"},toString:e.forwardCall("repr"),next:e.counter(t)}},cycle:function(t){var i=MochiKit.Iter,e=MochiKit.Base,n=[],o=i.iter(t);return{repr:function(){return"cycle(...)"},toString:e.forwardCall("repr"),next:function(){try{var t=o.next();return n.push(t),t}catch(t){if(t!=i.StopIteration)throw t;if(0===n.length)this.next=function(){throw i.StopIteration};else{var e=-1;this.next=function(){return e=(e+1)%n.length,n[e]}}return this.next()}}}},repeat:function(t,e){var i=MochiKit.Base;return void 0===e?{repr:function(){return"repeat("+i.repr(t)+")"},toString:i.forwardCall("repr"),next:function(){return t}}:{repr:function(){return"repeat("+i.repr(t)+", "+e+")"},toString:i.forwardCall("repr"),next:function(){if(e<=0)throw MochiKit.Iter.StopIteration;return--e,t}}},next:function(t){return t.next()},izip:function(t,e){var i=MochiKit.Base,n=MochiKit.Iter,o=n.next,r=i.map(n.iter,arguments);return{repr:function(){return"izip(...)"},toString:i.forwardCall("repr"),next:function(){return i.map(o,r)}}},ifilter:function(e,i){var t=MochiKit.Base;return i=MochiKit.Iter.iter(i),null===e&&(e=t.operator.truth),{repr:function(){return"ifilter(...)"},toString:t.forwardCall("repr"),next:function(){for(;;){var t=i.next();if(e(t))return t}}}},ifilterfalse:function(e,i){var t=MochiKit.Base;return i=MochiKit.Iter.iter(i),null===e&&(e=t.operator.truth),{repr:function(){return"ifilterfalse(...)"},toString:t.forwardCall("repr"),next:function(){for(;;){var t=i.next();if(!e(t))return t}}}},islice:function(e){var i=MochiKit.Iter,t=MochiKit.Base;e=i.iter(e);var n=0,o=0,r=1,s=-1;return 2==arguments.length?o=arguments[1]:3==arguments.length?(n=arguments[1],o=arguments[2]):(n=arguments[1],o=arguments[2],r=arguments[3]),{repr:function(){return"islice("+["...",n,o,r].join(", ")+")"},toString:t.forwardCall("repr"),next:function(){for(var t;s<n;)t=e.next(),s++;if(o<=n)throw i.StopIteration;return n+=r,t}}},imap:function(t,e,i){var n=MochiKit.Base,o=MochiKit.Iter,r=n.map(o.iter,n.extend(null,arguments,1)),s=n.map,a=o.next;return{repr:function(){return"imap(...)"},toString:n.forwardCall("repr"),next:function(){return t.apply(this,s(a,r))}}},applymap:function(t,e,i){return e=MochiKit.Iter.iter(e),{repr:function(){return"applymap(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){return t.apply(i,e.next())}}},chain:function(t,e){var i=MochiKit.Iter,n=MochiKit.Base;if(1==arguments.length)return i.iter(t);var o=n.map(i.iter,arguments);return{repr:function(){return"chain(...)"},toString:n.forwardCall("repr"),next:function(){for(;1<o.length;)try{return o[0].next()}catch(t){if(t!=i.StopIteration)throw t;return o.shift(),o[0].next()}if(1!=o.length)throw i.StopIteration;var t=o.shift();return this.next=n.bind("next",t),this.next()}}},takewhile:function(e,i){var n=MochiKit.Iter;return i=n.iter(i),{repr:function(){return"takewhile(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var t=i.next();return e(t)||(this.next=function(){throw n.StopIteration},this.next()),t}}},dropwhile:function(e,i){i=MochiKit.Iter.iter(i);var t=MochiKit.Base,n=t.bind;return{repr:function(){return"dropwhile(...)"},toString:t.forwardCall("repr"),next:function(){for(;;){var t=i.next();if(!e(t))break}return this.next=n("next",i),t}}},_tee:function(i,n,o){n.pos[i]=-1;var t=MochiKit.Base,r=t.listMin;return{repr:function(){return"tee("+i+", ...)"},toString:t.forwardCall("repr"),next:function(){var t,e=n.pos[i];return e==n.max?(t=o.next(),n.deque.push(t),n.max+=1,n.pos[i]+=1):(t=n.deque[e-n.min],n.pos[i]+=1,e==n.min&&r(n.pos)!=n.min&&(n.min+=1,n.deque.shift())),t}}},tee:function(t,e){var i=[],n={pos:[],deque:[],max:-1,min:-1};1!=arguments.length&&null!=e||(e=2);var o=MochiKit.Iter;t=o.iter(t);for(var r=o._tee,s=0;s<e;s++)i.push(r(s,n,t));return i},list:function(t){if(t instanceof Array)return t.slice();if("function"==typeof t&&!(t instanceof Function)&&"number"==typeof t.length){o=[];for(var e=0;e<t.length;e++)o.push(t[e]);return o}var i=MochiKit.Iter;t=i.iter(t);var n,o=[];try{for(;;)n=t.next(),o.push(n)}catch(t){if(t!=i.StopIteration)throw t;return o}},reduce:function(t,e,i){var n=i,o=MochiKit.Iter;if(e=o.iter(e),arguments.length<3){try{n=e.next()}catch(t){throw t==o.StopIteration&&(t=new TypeError("reduce() of empty sequence with no initial value")),t}0}try{for(;;)n=t(n,e.next())}catch(t){if(t!=o.StopIteration)throw t}return n},range:function(){var e=0,i=0,n=1;if(1==arguments.length)i=arguments[0];else if(2==arguments.length)e=arguments[0],i=arguments[1];else{if(3!=arguments.length)throw new TypeError("range() takes 1, 2, or 3 arguments!");e=arguments[0],i=arguments[1],n=arguments[2]}if(0===n)throw new TypeError("range() step must not be 0");return{next:function(){if(0<n&&i<=e||n<0&&e<=i)throw MochiKit.Iter.StopIteration;var t=e;return e+=n,t},repr:function(){return"range("+[e,i,n].join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")}},sum:function(t,e){null==e&&(e=0);var i=e,n=MochiKit.Iter;t=n.iter(t);try{for(;;)i+=t.next()}catch(t){if(t!=n.StopIteration)throw t}return i},exhaust:function(t){var e=MochiKit.Iter;t=e.iter(t);try{for(;;)t.next()}catch(t){if(t!=e.StopIteration)throw t}},forEach:function(t,e,i){var n=MochiKit.Base,o=MochiKit.Iter;if(2<arguments.length&&(e=n.bind(e,i)),n.isArrayLike(t)&&!o.isIterable(t))try{for(var r=0;r<t.length;r++)e(t[r])}catch(t){if(t!=o.StopIteration)throw t}else o.exhaust(o.imap(e,t))},every:function(t,e){var i=MochiKit.Iter;try{return i.ifilterfalse(e,t).next(),!1}catch(t){if(t!=i.StopIteration)throw t;return!0}},sorted:function(t,e){var i=MochiKit.Iter.list(t);return 1==arguments.length&&(e=MochiKit.Base.compare),i.sort(e),i},reversed:function(t){var e=MochiKit.Iter.list(t);return e.reverse(),e},some:function(t,e){var i=MochiKit.Iter;try{return i.ifilter(e,t).next(),!0}catch(t){if(t!=i.StopIteration)throw t;return!1}},iextend:function(t,e){var i=MochiKit.Base,n=MochiKit.Iter;if(i.isArrayLike(e)&&!n.isIterable(e))for(var o=0;o<e.length;o++)t.push(e[o]);else{e=n.iter(e);try{for(;;)t.push(e.next())}catch(t){if(t!=n.StopIteration)throw t}}return t},groupby:function(t,e){var i=MochiKit.Base,n=MochiKit.Iter;arguments.length<2&&(e=i.operator.identity),t=n.iter(t);var o,r=void 0,s=void 0;function a(){o=t.next(),s=e(o)}var l=!0,c=i.compare;return{repr:function(){return"groupby(...)"},next:function(){for(;0===c(s,r);)if(a(),l){l=!1;break}return[r=s,{next:function(){if(null==o&&a(),0!==c(s,r))throw n.StopIteration;return t=o,o=void 0,t;var t}}]}}},groupby_as_array:function(t,e){var i=MochiKit.Base,n=MochiKit.Iter;arguments.length<2&&(e=i.operator.identity),t=n.iter(t);for(var o,r=[],s=!0,a=i.compare;;){try{var l=t.next(),c=e(l)}catch(t){if(t==n.StopIteration)break;throw t}if(s||0!==a(c,o)){var h=[];r.push([c,h])}h.push(l),s=!1,o=c}return r},arrayLikeIter:function(t){var e=0;return{repr:function(){return"arrayLikeIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(e>=t.length)throw MochiKit.Iter.StopIteration;return t[e++]}}},hasIterateNext:function(t){return t&&"function"==typeof t.iterateNext},iterateNextIter:function(e){return{repr:function(){return"iterateNextIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var t=e.iterateNext();if(null==t)throw MochiKit.Iter.StopIteration;return t}}}}),MochiKit.Iter.EXPORT_OK=["iteratorRegistry","arrayLikeIter","hasIterateNext","iterateNextIter"],MochiKit.Iter.EXPORT=["StopIteration","registerIteratorFactory","iter","count","cycle","repeat","next","izip","ifilter","ifilterfalse","islice","imap","applymap","chain","takewhile","dropwhile","tee","list","reduce","range","sum","exhaust","forEach","every","sorted","reversed","some","iextend","groupby","groupby_as_array"],MochiKit.Iter.__new__=function(){var t=MochiKit.Base;"undefined"!=typeof StopIteration?this.StopIteration=StopIteration:this.StopIteration=new t.NamedError("StopIteration"),this.iteratorRegistry=new t.AdapterRegistry,this.registerIteratorFactory("arrayLike",t.isArrayLike,this.arrayLikeIter),this.registerIteratorFactory("iterateNext",this.hasIterateNext,this.iterateNextIter),this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)},t.nameFunctions(this)},MochiKit.Iter.__new__(),MochiKit.__export__&&(reduce=MochiKit.Iter.reduce),MochiKit.Base._exportSymbols(this,MochiKit.Iter),MochiKit.Base._deps("Logging",["Base"]),MochiKit.Logging.NAME="MochiKit.Logging",MochiKit.Logging.VERSION="1.4.2",MochiKit.Logging.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Logging.toString=function(){return this.__repr__()},MochiKit.Logging.EXPORT=["LogLevel","LogMessage","Logger","alertListener","logger","log","logError","logDebug","logFatal","logWarning"],MochiKit.Logging.EXPORT_OK=["logLevelAtLeast","isLogMessage","compareLogMessage"],MochiKit.Logging.LogMessage=function(t,e,i){this.num=t,this.level=e,this.info=i,this.timestamp=new Date},MochiKit.Logging.LogMessage.prototype={repr:function(){var t=MochiKit.Base;return"LogMessage("+t.map(t.repr,[this.num,this.level,this.info]).join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")},MochiKit.Base.update(MochiKit.Logging,{logLevelAtLeast:function(i){var n=MochiKit.Logging;return"string"==typeof i&&(i=n.LogLevel[i]),function(t){var e=t.level;return"string"==typeof e&&(e=n.LogLevel[e]),i<=e}},isLogMessage:function(){for(var t=MochiKit.Logging.LogMessage,e=0;e<arguments.length;e++)if(!(arguments[e]instanceof t))return!1;return!0},compareLogMessage:function(t,e){return MochiKit.Base.compare([t.level,t.info],[e.level,e.info])},alertListener:function(t){alert("num: "+t.num+"\nlevel: "+t.level+"\ninfo: "+t.info.join(" "))}}),MochiKit.Logging.Logger=function(t){this.counter=0,null==t&&(t=-1),this.maxSize=t,this._messages=[],this.listeners={},this.useNativeConsole=!1},MochiKit.Logging.Logger.prototype={clear:function(){this._messages.splice(0,this._messages.length)},logToConsole:function(t){"undefined"!=typeof window&&window.console&&window.console.log?window.console.log(t.replace(/%/g,"％")):"undefined"!=typeof opera&&opera.postError?opera.postError(t):"function"==typeof printfire?printfire(t):"undefined"!=typeof Debug&&Debug.writeln?Debug.writeln(t):"undefined"!=typeof debug&&debug.trace&&debug.trace(t)},dispatchListeners:function(t){for(var e in this.listeners){var i=this.listeners[e];i.ident!=e||i[0]&&!i[0](t)||i[1](t)}},addListener:function(t,e,i){"string"==typeof e&&(e=MochiKit.Logging.logLevelAtLeast(e));var n=[e,i];n.ident=t,this.listeners[t]=n},removeListener:function(t){delete this.listeners[t]},baseLog:function(t,e){"number"==typeof t&&(t=t>=MochiKit.Logging.LogLevel.FATAL?"FATAL":t>=MochiKit.Logging.LogLevel.ERROR?"ERROR":t>=MochiKit.Logging.LogLevel.WARNING?"WARNING":t>=MochiKit.Logging.LogLevel.INFO?"INFO":"DEBUG");var i=new MochiKit.Logging.LogMessage(this.counter,t,MochiKit.Base.extend(null,arguments,1));for(this._messages.push(i),this.dispatchListeners(i),this.useNativeConsole&&this.logToConsole(i.level+": "+i.info.join(" ")),this.counter+=1;0<=this.maxSize&&this._messages.length>this.maxSize;)this._messages.shift()},getMessages:function(t){var e=0;return null!=t&&(e=Math.max(0,this._messages.length-t)),this._messages.slice(e)},getMessageText:function(t){null==t&&(t=30);var e=this.getMessages(t);if(e.length){var i=map(function(t){return"\n  ["+t.num+"] "+t.level+": "+t.info.join(" ")},e);return i.unshift("LAST "+e.length+" MESSAGES:"),i.join("")}return""},debuggingBookmarklet:function(t){void 0===MochiKit.LoggingPane?alert(this.getMessageText()):MochiKit.LoggingPane.createLoggingPane(t||!1)}},MochiKit.Logging.__new__=function(){this.LogLevel={ERROR:40,FATAL:50,WARNING:30,INFO:20,DEBUG:10};var t=MochiKit.Base;t.registerComparator("LogMessage",this.isLogMessage,this.compareLogMessage);var e=t.partial,i=this.Logger,n=i.prototype.baseLog;t.update(this.Logger.prototype,{debug:e(n,"DEBUG"),log:e(n,"INFO"),error:e(n,"ERROR"),fatal:e(n,"FATAL"),warning:e(n,"WARNING")});function o(t){return function(){r.logger[t].apply(r.logger,arguments)}}var r=this;this.log=o("log"),this.logError=o("error"),this.logDebug=o("debug"),this.logFatal=o("fatal"),this.logWarning=o("warning"),this.logger=new i,this.logger.useNativeConsole=!0,this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)},t.nameFunctions(this)},"undefined"==typeof printfire&&"undefined"!=typeof document&&document.createEvent&&"undefined"!=typeof dispatchEvent&&(printfire=function(){printfire.args=arguments;var t=document.createEvent("Events");t.initEvent("printfire",!1,!0),dispatchEvent(t)}),MochiKit.Logging.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Logging),MochiKit.Base._deps("DateTime",["Base"]),MochiKit.DateTime.NAME="MochiKit.DateTime",MochiKit.DateTime.VERSION="1.4.2",MochiKit.DateTime.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.DateTime.toString=function(){return this.__repr__()},MochiKit.DateTime.isoDate=function(t){if("string"!=typeof(t+="")||0===t.length)return null;var e=t.split("-");if(0===e.length)return null;var i=new Date(e[0],e[1]-1,e[2]);return i.setFullYear(e[0]),i.setMonth(e[1]-1),i.setDate(e[2]),i},MochiKit.DateTime._isoRegexp=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/,MochiKit.DateTime.isoTimestamp=function(t){if("string"!=typeof(t+="")||0===t.length)return null;var e,i,n,o,r,s,a,l,c=t.match(MochiKit.DateTime._isoRegexp);return null==c?null:(e=parseInt(c[1],10),void 0===c[2]||""===c[2]?new Date(e):(i=parseInt(c[2],10)-1,n=parseInt(c[3],10),void 0===c[4]||""===c[4]?new Date(e,i,n):(o=parseInt(c[4],10),r=parseInt(c[5],10),s=void 0!==c[6]&&""!==c[6]?parseInt(c[6],10):0,a=void 0!==c[7]&&""!==c[7]?Math.round(1e3*parseFloat("0."+c[7])):0,void 0!==c[8]&&""!==c[8]||void 0!==c[9]&&""!==c[9]?(void 0!==c[9]&&""!==c[9]?(l=36e5*parseInt(c[10],10),void 0!==c[11]&&""!==c[11]&&(l+=6e4*parseInt(c[11],10)),"-"==c[9]&&(l=-l)):l=0,new Date(Date.UTC(e,i,n,o,r,s,a)-l)):new Date(e,i,n,o,r,s,a))))},MochiKit.DateTime.toISOTime=function(t,e){if(null==t)return null;var i=t.getHours(),n=t.getMinutes(),o=t.getSeconds();return[e&&i<10?"0"+i:i,n<10?"0"+n:n,o<10?"0"+o:o].join(":")},MochiKit.DateTime.toISOTimestamp=function(t,e){if(null==t)return null;var i=e?"T":" ",n=e?"Z":"";return e&&(t=new Date(t.getTime()+6e4*t.getTimezoneOffset())),MochiKit.DateTime.toISODate(t)+i+MochiKit.DateTime.toISOTime(t,e)+n},MochiKit.DateTime.toISODate=function(t){if(null==t)return null;var e=MochiKit.DateTime._padTwo;return[(0,MochiKit.DateTime._padFour)(t.getFullYear()),e(t.getMonth()+1),e(t.getDate())].join("-")},MochiKit.DateTime.americanDate=function(t){if("string"!=typeof(t+="")||0===t.length)return null;var e=t.split("/");return new Date(e[2],e[0]-1,e[1])},MochiKit.DateTime._padTwo=function(t){return 9<t?t:"0"+t},MochiKit.DateTime._padFour=function(t){switch(t.toString().length){case 1:return"000"+t;case 2:return"00"+t;case 3:return"0"+t;case 4:default:return t}},MochiKit.DateTime.toPaddedAmericanDate=function(t){if(null==t)return null;var e=MochiKit.DateTime._padTwo;return[e(t.getMonth()+1),e(t.getDate()),t.getFullYear()].join("/")},MochiKit.DateTime.toAmericanDate=function(t){return null==t?null:[t.getMonth()+1,t.getDate(),t.getFullYear()].join("/")},MochiKit.DateTime.EXPORT=["isoDate","isoTimestamp","toISOTime","toISOTimestamp","toISODate","americanDate","toPaddedAmericanDate","toAmericanDate"],MochiKit.DateTime.EXPORT_OK=[],MochiKit.DateTime.EXPORT_TAGS={":common":MochiKit.DateTime.EXPORT,":all":MochiKit.DateTime.EXPORT},MochiKit.DateTime.__new__=function(){var t=this.NAME+".";for(var e in this){var i=this[e];if("function"==typeof i&&void 0===i.NAME)try{i.NAME=t+e}catch(t){}}},MochiKit.DateTime.__new__(),void 0!==MochiKit.Base?MochiKit.Base._exportSymbols(this,MochiKit.DateTime):function(t,e){if("undefined"==typeof JSAN&&"undefined"==typeof dojo||!1===MochiKit.__export__)for(var i=e.EXPORT_TAGS[":all"],n=0;n<i.length;n++)t[i[n]]=e[i[n]]}(this,MochiKit.DateTime),MochiKit.Base._deps("Format",["Base"]),MochiKit.Format.NAME="MochiKit.Format",MochiKit.Format.VERSION="1.4.2",MochiKit.Format.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Format.toString=function(){return this.__repr__()},MochiKit.Format._numberFormatter=function(c,h,u,f,p,d,g,m,M){return function(t){if(null==(t=parseFloat(t))||isNaN(t))return c;var e=h,i=u;t<0?t=-t:e=e.replace(/-/,"");var n=MochiKit.Format.formatLocale(f);p&&(t*=100,i=n.percent+i);for(var o=(t=MochiKit.Format.roundToFixed(t,d)).split(/\./),r=o[0],s=1==o.length?"":o[1],a="";r.length<g;)r="0"+r;if(m)for(;r.length>m;){var l=r.length-m;a=n.separator+r.substring(l,r.length)+a,r=r.substring(0,l)}if(a=r+a,0<d){for(;s.length<M;)s+="0";a=a+n.decimal+s}return e+a+i}},MochiKit.Format.numberFormatter=function(t,e,i){void 0===e&&(e="");var n=t.match(/((?:[0#]+,)?[0#]+)(?:\.([0#]+))?(%)?/);if(!n)throw TypeError("Invalid pattern");var o=t.substr(0,n.index),r=t.substr(n.index+n[0].length);-1==o.search(/-/)&&(o+="-");var s,a=n[1],l="string"==typeof n[2]&&""!=n[2]?n[2]:"",c="string"==typeof n[3]&&""!=n[3],h=a.split(/,/);void 0===i&&(i="default"),s=1==h.length?null:h[1].length;var u=a.length-a.replace(/0/g,"").length,f=l.length-l.replace(/0/g,"").length,p=l.length,d=MochiKit.Format._numberFormatter(e,o,r,i,c,p,u,s,f),g=MochiKit.Base;if(g){var m=g.concat(arguments);d.repr=function(){return[self.NAME,"(",map(g.repr,m).join(", "),")"].join("")}}return d},MochiKit.Format.formatLocale=function(t){if(null==t&&(t="default"),"string"!=typeof t)return t;var e=MochiKit.Format.LOCALE[t];return"string"==typeof e&&(e=arguments.callee(e),MochiKit.Format.LOCALE[t]=e),e},MochiKit.Format.twoDigitAverage=function(t,e){if(e){var i=t/e;if(!isNaN(i))return MochiKit.Format.twoDigitFloat(i)}return"0"},MochiKit.Format.twoDigitFloat=function(t){var e=roundToFixed(t,2);return 0<e.indexOf(".00")?e.substring(0,e.length-3):"0"==e.charAt(e.length-1)?e.substring(0,e.length-1):e},MochiKit.Format.lstrip=function(t,e){return"string"!=typeof(t+="")?null:e?t.replace(new RegExp("^["+e+"]+"),""):t.replace(/^\s+/,"")},MochiKit.Format.rstrip=function(t,e){return"string"!=typeof(t+="")?null:e?t.replace(new RegExp("["+e+"]+$"),""):t.replace(/\s+$/,"")},MochiKit.Format.strip=function(t,e){var i=MochiKit.Format;return i.rstrip(i.lstrip(t,e),e)},MochiKit.Format.truncToFixed=function(t,e){var i=Math.floor(t).toFixed(0);if(t<0&&"-"!=(i=Math.ceil(t).toFixed(0)).charAt(0)&&0<e&&(i="-"+i),i.indexOf("e")<0&&0<e){var n=t.toString();for((n=0<n.indexOf("e")||n.indexOf(".")<0?".":n.substring(n.indexOf("."))).length-1>e&&(n=n.substring(0,e+1));n.length-1<e;)n+="0";i+=n}return i},MochiKit.Format.roundToFixed=function(t,e){var i=Math.abs(t)+.5*Math.pow(10,-e),n=MochiKit.Format.truncToFixed(i,e);return t<0&&(n="-"+n),n},MochiKit.Format.percentFormat=function(t){return MochiKit.Format.twoDigitFloat(100*t)+"%"},MochiKit.Format.EXPORT=["truncToFixed","roundToFixed","numberFormatter","formatLocale","twoDigitAverage","twoDigitFloat","percentFormat","lstrip","rstrip","strip"],MochiKit.Format.LOCALE={en_US:{separator:",",decimal:".",percent:"%"},de_DE:{separator:".",decimal:",",percent:"%"},pt_BR:{separator:".",decimal:",",percent:"%"},fr_FR:{separator:" ",decimal:",",percent:"%"},default:"en_US"},MochiKit.Format.EXPORT_OK=[],MochiKit.Format.EXPORT_TAGS={":all":MochiKit.Format.EXPORT,":common":MochiKit.Format.EXPORT},MochiKit.Format.__new__=function(){var t,e,i=this.NAME+".";for(t in this.LOCALE)"object"==typeof(e=this.LOCALE[t])&&(e.repr=function(){return this.NAME},e.NAME=i+"LOCALE."+t);for(t in this)if("function"==typeof(e=this[t])&&void 0===e.NAME)try{e.NAME=i+t}catch(t){}},MochiKit.Format.__new__(),void 0!==MochiKit.Base?MochiKit.Base._exportSymbols(this,MochiKit.Format):function(t,e){if("undefined"==typeof JSAN&&"undefined"==typeof dojo||!1===MochiKit.__export__)for(var i=e.EXPORT_TAGS[":all"],n=0;n<i.length;n++)t[i[n]]=e[i[n]]}(this,MochiKit.Format),MochiKit.Base._deps("Async",["Base"]),MochiKit.Async.NAME="MochiKit.Async",MochiKit.Async.VERSION="1.4.2",MochiKit.Async.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Async.toString=function(){return this.__repr__()},MochiKit.Async.Deferred=function(t){this.chain=[],this.id=this._nextId(),this.fired=-1,this.paused=0,this.results=[null,null],this.canceller=t,this.silentlyCancelled=!1,this.chained=!1},MochiKit.Async.Deferred.prototype={repr:function(){var t;return t=-1==this.fired?"unfired":0===this.fired?"success":"error","Deferred("+this.id+", "+t+")"},toString:MochiKit.Base.forwardCall("repr"),_nextId:MochiKit.Base.counter(),cancel:function(){var t=MochiKit.Async;-1==this.fired?(this.canceller?this.canceller(this):this.silentlyCancelled=!0,-1==this.fired&&this.errback(new t.CancelledError(this))):0===this.fired&&this.results[0]instanceof t.Deferred&&this.results[0].cancel()},_resback:function(t){this.fired=t instanceof Error?1:0,this.results[this.fired]=t,this._fire()},_check:function(){if(-1!=this.fired){if(!this.silentlyCancelled)throw new MochiKit.Async.AlreadyCalledError(this);this.silentlyCancelled=!1}},callback:function(t){if(this._check(),t instanceof MochiKit.Async.Deferred)throw new Error("Deferred instances can only be chained if they are the result of a callback");this._resback(t)},errback:function(t){this._check();var e=MochiKit.Async;if(t instanceof e.Deferred)throw new Error("Deferred instances can only be chained if they are the result of a callback");t instanceof Error||(t=new e.GenericError(t)),this._resback(t)},addBoth:function(t){return 1<arguments.length&&(t=MochiKit.Base.partial.apply(null,arguments)),this.addCallbacks(t,t)},addCallback:function(t){return 1<arguments.length&&(t=MochiKit.Base.partial.apply(null,arguments)),this.addCallbacks(t,null)},addErrback:function(t){return 1<arguments.length&&(t=MochiKit.Base.partial.apply(null,arguments)),this.addCallbacks(null,t)},addCallbacks:function(t,e){if(this.chained)throw new Error("Chained Deferreds can not be re-used");return this.chain.push([t,e]),0<=this.fired&&this._fire(),this},_fire:function(){for(var t=this.chain,e=this.fired,i=this.results[e],n=this,o=null;0<t.length&&0===this.paused;){var r=t.shift()[e];if(null!==r)try{e=(i=r(i))instanceof Error?1:0,i instanceof MochiKit.Async.Deferred&&(o=function(t){n._resback(t),n.paused--,0===n.paused&&0<=n.fired&&n._fire()},this.paused++)}catch(t){e=1,t instanceof Error||(t=new MochiKit.Async.GenericError(t)),i=t}}this.fired=e,this.results[e]=i,o&&this.paused&&(i.addBoth(o),i.chained=!0)}},MochiKit.Base.update(MochiKit.Async,{evalJSONRequest:function(t){return MochiKit.Base.evalJSON(t.responseText)},succeed:function(t){var e=new MochiKit.Async.Deferred;return e.callback.apply(e,arguments),e},fail:function(t){var e=new MochiKit.Async.Deferred;return e.errback.apply(e,arguments),e},getXMLHttpRequest:function(){var t=arguments.callee;if(!t.XMLHttpRequest)for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},function(){throw new MochiKit.Async.BrowserComplianceError("Browser does not support XMLHttpRequest")}],i=0;i<e.length;i++){var n=e[i];try{return(t.XMLHttpRequest=n)()}catch(t){}}return t.XMLHttpRequest()},_xhr_onreadystatechange:function(t){var e=MochiKit.Base;if(4==this.readyState){try{this.onreadystatechange=null}catch(t){try{this.onreadystatechange=e.noop}catch(t){}}var i=null;try{!(i=this.status)&&e.isNotEmpty(this.responseText)&&(i=304)}catch(t){}if(200==i||201==i||204==i||304==i||1223==i)t.callback(this);else{var n=new MochiKit.Async.XMLHttpRequestError(this,"Request failed");n.number,t.errback(n)}}},_xhr_canceller:function(e){try{e.onreadystatechange=null}catch(t){try{e.onreadystatechange=MochiKit.Base.noop}catch(t){}}e.abort()},sendXMLHttpRequest:function(e,t){null==t&&(t="");var i=MochiKit.Base,n=MochiKit.Async,o=new n.Deferred(i.partial(n._xhr_canceller,e));try{e.onreadystatechange=i.bind(n._xhr_onreadystatechange,e,o),e.send(t)}catch(t){try{e.onreadystatechange=null}catch(t){}o.errback(t)}return o},doXHR:function(t,e){var i=MochiKit.Async;return i.callLater(0,i._doXHR,t,e)},_doXHR:function(t,e){var i=MochiKit.Base;e=i.update({method:"GET",sendContent:""},e);var n=MochiKit.Async,o=n.getXMLHttpRequest();if(e.queryString){var r=i.queryString(e.queryString);r&&(t+="?"+r)}if("username"in e?o.open(e.method,t,!0,e.username,e.password):o.open(e.method,t,!0),o.overrideMimeType&&e.mimeType&&o.overrideMimeType(e.mimeType),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.headers){var s=e.headers;i.isArrayLike(s)||(s=i.items(s));for(var a=0;a<s.length;a++){var l=s[a],c=l[0],h=l[1];o.setRequestHeader(c,h)}}return n.sendXMLHttpRequest(o,e.sendContent)},_buildURL:function(t){if(1<arguments.length){var e=MochiKit.Base,i=e.queryString.apply(null,e.extend(null,arguments,1));if(i)return t+"?"+i}return t},doSimpleXMLHttpRequest:function(t){var e=MochiKit.Async;return t=e._buildURL.apply(e,arguments),e.doXHR(t)},loadJSONDoc:function(t){var e=MochiKit.Async;t=e._buildURL.apply(e,arguments);var i=e.doXHR(t,{mimeType:"text/plain",headers:[["Accept","application/json"]]});return i=i.addCallback(e.evalJSONRequest)},wait:function(t,e){var i=new MochiKit.Async.Deferred,n=MochiKit.Base;void 0!==e&&i.addCallback(function(){return e});var o=setTimeout(n.bind("callback",i),Math.floor(1e3*t));return i.canceller=function(){try{clearTimeout(o)}catch(t){}},i},callLater:function(t,e){var i=MochiKit.Base,n=i.partial.apply(i,i.extend(null,arguments,1));return MochiKit.Async.wait(t).addCallback(function(t){return n()})}}),MochiKit.Async.DeferredLock=function(){this.waiting=[],this.locked=!1,this.id=this._nextId()},MochiKit.Async.DeferredLock.prototype={__class__:MochiKit.Async.DeferredLock,acquire:function(){var t=new MochiKit.Async.Deferred;return this.locked?this.waiting.push(t):(this.locked=!0,t.callback(this)),t},release:function(){if(!this.locked)throw TypeError("Tried to release an unlocked DeferredLock");this.locked=!1,0<this.waiting.length&&(this.locked=!0,this.waiting.shift().callback(this))},_nextId:MochiKit.Base.counter(),repr:function(){var t;return t=this.locked?"locked, "+this.waiting.length+" waiting":"unlocked","DeferredLock("+this.id+", "+t+")"},toString:MochiKit.Base.forwardCall("repr")},MochiKit.Async.DeferredList=function(t,e,i,n,o){MochiKit.Async.Deferred.apply(this,[o]),this.list=t;var r=[];this.resultList=r,this.finishedCount=0,this.fireOnOneCallback=e,this.fireOnOneErrback=i,this.consumeErrors=n;for(var s=MochiKit.Base.bind(this._cbDeferred,this),a=0;a<t.length;a++){var l=t[a];r.push(void 0),l.addCallback(s,a,!0),l.addErrback(s,a,!1)}0!==t.length||e||this.callback(this.resultList)},MochiKit.Async.DeferredList.prototype=new MochiKit.Async.Deferred,MochiKit.Async.DeferredList.prototype._cbDeferred=function(t,e,i){return this.resultList[t]=[e,i],this.finishedCount+=1,-1==this.fired&&(e&&this.fireOnOneCallback?this.callback([t,i]):!e&&this.fireOnOneErrback?this.errback(i):this.finishedCount==this.list.length&&this.callback(this.resultList)),!e&&this.consumeErrors&&(i=null),i},MochiKit.Async.gatherResults=function(t){var e=new MochiKit.Async.DeferredList(t,!1,!0,!1);return e.addCallback(function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i][1]);return e}),e},MochiKit.Async.maybeDeferred=function(t){var e,i=MochiKit.Async;try{var n=t.apply(null,MochiKit.Base.extend([],arguments,1));e=n instanceof i.Deferred?n:n instanceof Error?i.fail(n):i.succeed(n)}catch(t){e=i.fail(t)}return e},MochiKit.Async.EXPORT=["AlreadyCalledError","CancelledError","BrowserComplianceError","GenericError","XMLHttpRequestError","Deferred","succeed","fail","getXMLHttpRequest","doSimpleXMLHttpRequest","loadJSONDoc","wait","callLater","sendXMLHttpRequest","DeferredLock","DeferredList","gatherResults","maybeDeferred","doXHR"],MochiKit.Async.EXPORT_OK=["evalJSONRequest"],MochiKit.Async.__new__=function(){var t=MochiKit.Base,e=t.partial(t._newNamedError,this);e("AlreadyCalledError",function(t){this.deferred=t}),e("CancelledError",function(t){this.deferred=t}),e("BrowserComplianceError",function(t){this.message=t}),e("GenericError",function(t){this.message=t}),e("XMLHttpRequestError",function(t,e){this.req=t,this.message=e;try{this.number=t.status}catch(t){}}),this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)},t.nameFunctions(this)},MochiKit.Async.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Async),MochiKit.Base._deps("DOM",["Base"]),MochiKit.DOM.NAME="MochiKit.DOM",MochiKit.DOM.VERSION="1.4.2",MochiKit.DOM.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.DOM.toString=function(){return this.__repr__()},MochiKit.DOM.EXPORT=["removeEmptyTextNodes","formContents","currentWindow","currentDocument","withWindow","withDocument","registerDOMConverter","coerceToDOM","createDOM","createDOMFunc","isChildNode","getNodeAttribute","removeNodeAttribute","setNodeAttribute","updateNodeAttributes","appendChildNodes","insertSiblingNodesAfter","insertSiblingNodesBefore","replaceChildNodes","removeElement","swapDOM","BUTTON","TT","PRE","H1","H2","H3","H4","H5","H6","BR","CANVAS","HR","LABEL","TEXTAREA","FORM","STRONG","SELECT","OPTION","OPTGROUP","LEGEND","FIELDSET","P","UL","OL","LI","DL","DT","DD","TD","TR","THEAD","TBODY","TFOOT","TABLE","TH","INPUT","SPAN","A","DIV","IMG","getElement","$","getElementsByTagAndClassName","addToCallStack","addLoadEvent","focusOnLoad","setElementClass","toggleElementClass","addElementClass","removeElementClass","swapElementClass","hasElementClass","computedStyle","escapeHTML","toHTML","emitHTML","scrapeText","getFirstParentByTagAndClassName","getFirstElementByTagAndClassName"],MochiKit.DOM.EXPORT_OK=["domConverters"],MochiKit.DOM.DEPRECATED=[["computedStyle","MochiKit.Style.getStyle","1.4"],["elementDimensions","MochiKit.Style.getElementDimensions","1.4"],["elementPosition","MochiKit.Style.getElementPosition","1.4"],["getViewportDimensions","MochiKit.Style.getViewportDimensions","1.4"],["hideElement","MochiKit.Style.hideElement","1.4"],["makeClipping","MochiKit.Style.makeClipping","1.4.1"],["makePositioned","MochiKit.Style.makePositioned","1.4.1"],["setElementDimensions","MochiKit.Style.setElementDimensions","1.4"],["setElementPosition","MochiKit.Style.setElementPosition","1.4"],["setDisplayForElement","MochiKit.Style.setDisplayForElement","1.4"],["setOpacity","MochiKit.Style.setOpacity","1.4"],["showElement","MochiKit.Style.showElement","1.4"],["undoClipping","MochiKit.Style.undoClipping","1.4.1"],["undoPositioned","MochiKit.Style.undoPositioned","1.4.1"],["Coordinates","MochiKit.Style.Coordinates","1.4"],["Dimensions","MochiKit.Style.Dimensions","1.4"]],MochiKit.Base.update(MochiKit.DOM,{currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(t,e){var i,n=MochiKit.DOM,o=n._document,r=n._window;try{n._window=t,n._document=t.document,i=e()}catch(t){throw n._window=r,n._document=o,t}return n._window=r,n._document=o,i},formContents:function(t){var l=[],c=[],h=MochiKit.Base,e=MochiKit.DOM;return t=null==t?e._document.body:e.getElement(t),h.nodeWalk(t,function(t){var e=t.name;if(h.isNotEmpty(e)){var i=t.tagName.toUpperCase();if("INPUT"===i&&("radio"==t.type||"checkbox"==t.type)&&!t.checked)return null;if("SELECT"!==i)return"FORM"===i||"P"===i||"SPAN"===i||"DIV"===i?t.childNodes:(l.push(e),c.push(t.value||""),null);if("select-one"==t.type){if(0<=t.selectedIndex){if(!(s=(r=t.options[t.selectedIndex]).value))(a=r.outerHTML)&&!a.match(/^[^>]+\svalue\s*=/i)&&(s=r.text);return l.push(e),c.push(s),null}return l.push(e),c.push(""),null}var n=t.options;if(!n.length)return l.push(e),c.push(""),null;for(var o=0;o<n.length;o++){var r;if((r=n[o]).selected){var s,a;if(!(s=r.value))(a=r.outerHTML)&&!a.match(/^[^>]+\svalue\s*=/i)&&(s=r.text);l.push(e),c.push(s)}}return null}return t.childNodes}),[l,c]},withDocument:function(t,e){var i,n=MochiKit.DOM,o=n._document;try{n._document=t,i=e()}catch(t){throw n._document=o,t}return n._document=o,i},registerDOMConverter:function(t,e,i,n){MochiKit.DOM.domConverters.register(t,e,i,n)},coerceToDOM:function(t,e){var i=MochiKit.Base,n=MochiKit.Iter,o=MochiKit.DOM;if(n)var r=n.iter,s=n.repeat;for(var a=i.map,l=o.domConverters,c=arguments.callee,h=i.NotFound;;){if(null==t)return null;if("function"!=typeof t||"number"!=typeof t.length||t instanceof Function||(t=n?n.list(t):i.extend(null,t)),void 0!==t.nodeType&&0<t.nodeType)return t;if("number"!=typeof t&&"boolean"!=typeof t||(t=t.toString()),"string"==typeof t)return o._document.createTextNode(t);if("function"!=typeof t.__dom__)if("function"!=typeof t.dom){if("function"!=typeof t){if(n){var u=null;try{u=r(t)}catch(t){}if(u)return a(c,u,s(e))}else if(i.isArrayLike(t)){return a(function(t){return c(t,e)},t)}try{t=l.match(t,e);continue}catch(t){if(t!=h)throw t}return o._document.createTextNode(t.toString())}t=t.apply(e,[e])}else t=t.dom(e);else t=t.__dom__(e)}},isChildNode:function(t,e){var i=MochiKit.DOM;if("string"==typeof t&&(t=i.getElement(t)),"string"==typeof e&&(e=i.getElement(e)),null==t)return!1;for(;null!=t&&t!==i._document;){if(t===e)return!0;t=t.parentNode}return!1},setNodeAttribute:function(t,e,i){var n={};n[e]=i;try{return MochiKit.DOM.updateNodeAttributes(t,n)}catch(t){}return null},getNodeAttribute:function(t,e){var i=MochiKit.DOM,n=i.attributeArray.renames[e],o=i.attributeArray.ignoreAttr[e];t=i.getElement(t);try{if(n)return t[n];var r=t.getAttribute(e);if(r!=o)return r}catch(t){}return null},removeNodeAttribute:function(t,e){var i=MochiKit.DOM,n=i.attributeArray.renames[e];t=i.getElement(t);try{return n?t[n]:t.removeAttribute(e)}catch(t){}return null},updateNodeAttributes:function(t,e){var i=t,n=MochiKit.DOM;if("string"==typeof t&&(i=n.getElement(t)),e){var o=MochiKit.Base.updatetree;if(n.attributeArray.compliant)for(var r in e){var s=e[r];"object"==typeof s&&"object"==typeof i[r]?"style"==r&&MochiKit.Style?MochiKit.Style.setStyle(i,s):o(i[r],s):"on"==r.substring(0,2)?("string"==typeof s&&(s=new Function(s)),i[r]=s):i.setAttribute(r,s),"string"==typeof i[r]&&i[r]!=s&&(i[r]=s)}else{var a=n.attributeArray.renames;for(var r in e){s=e[r];var l=a[r];"style"==r&&"string"==typeof s?i.style.cssText=s:"string"==typeof l?i[l]=s:"object"==typeof i[r]&&"object"==typeof s?"style"==r&&MochiKit.Style?MochiKit.Style.setStyle(i,s):o(i[r],s):"on"==r.substring(0,2)?("string"==typeof s&&(s=new Function(s)),i[r]=s):i.setAttribute(r,s),"string"==typeof i[r]&&i[r]!=s&&(i[r]=s)}}}return i},appendChildNodes:function(t){var e=t,i=MochiKit.DOM;"string"==typeof t&&(e=i.getElement(t));for(var n=[i.coerceToDOM(MochiKit.Base.extend(null,arguments,1),e)],o=MochiKit.Base.concat;n.length;){var r=n.shift();null==r||("number"==typeof r.nodeType?e.appendChild(r):n=o(r,n))}return e},insertSiblingNodesBefore:function(t){var e=t,i=MochiKit.DOM;"string"==typeof t&&(e=i.getElement(t));for(var n=[i.coerceToDOM(MochiKit.Base.extend(null,arguments,1),e)],o=e.parentNode,r=MochiKit.Base.concat;n.length;){var s=n.shift();null==s||("number"==typeof s.nodeType?o.insertBefore(s,e):n=r(s,n))}return o},insertSiblingNodesAfter:function(t){var e=t,i=MochiKit.DOM;"string"==typeof t&&(e=i.getElement(t));var n=[i.coerceToDOM(MochiKit.Base.extend(null,arguments,1),e)];return e.nextSibling?i.insertSiblingNodesBefore(e.nextSibling,n):i.appendChildNodes(e.parentNode,n)},replaceChildNodes:function(t){var e,i=t,n=MochiKit.DOM;for("string"==typeof t&&(t=i=n.getElement(t));e=i.firstChild;)i.removeChild(e);return arguments.length<2?i:n.appendChildNodes.apply(this,arguments)},createDOM:function(t,e){var i,n=MochiKit.DOM,o=MochiKit.Base;if("string"==typeof e||"number"==typeof e){var r=o.extend([t,null],arguments,1);return arguments.callee.apply(this,r)}if("string"==typeof t){var s=n._xhtml;if(e&&!n.attributeArray.compliant){var a="";"name"in e&&(a+=' name="'+n.escapeHTML(e.name)+'"'),"input"==t&&"type"in e&&(a+=' type="'+n.escapeHTML(e.type)+'"'),a&&(t="<"+t+a+">",s=!1)}var l=n._document;i=s&&l===document?l.createElementNS("http://www.w3.org/1999/xhtml",t):l.createElement(t)}else i=t;if(e&&n.updateNodeAttributes(i,e),arguments.length<=2)return i;r=o.extend([i],arguments,2);return n.appendChildNodes.apply(this,r)},createDOMFunc:function(){var t=MochiKit.Base;return t.partial.apply(this,t.extend([MochiKit.DOM.createDOM],arguments))},removeElement:function(t){var e=MochiKit.DOM,i=e.coerceToDOM(e.getElement(t));return i.parentNode.removeChild(i),i},swapDOM:function(t,e){var i=MochiKit.DOM,n=(t=i.getElement(t)).parentNode;return e?(e=i.coerceToDOM(i.getElement(e),n),n.replaceChild(e,t)):n.removeChild(t),e},getElement:function(t){var e=MochiKit.DOM;return 1==arguments.length?"string"==typeof t?e._document.getElementById(t):t:MochiKit.Base.map(e.getElement,arguments)},getElementsByTagAndClassName:function(t,e,i){var n=MochiKit.DOM;if(null==t&&(t="*"),null==i&&(i=n._document),null==(i=n.getElement(i)))return[];var o=i.getElementsByTagName(t)||n._document.all;if(null==e)return MochiKit.Base.extend(null,o);for(var r=[],s=0;s<o.length;s++){var a=o[s],l=a.className;if("string"!=typeof l&&(l=a.getAttribute("class")),"string"==typeof l)for(var c=l.split(" "),h=0;h<c.length;h++)if(c[h]==e){r.push(a);break}}return r},_newCallStack:function(i,n){function t(){for(var t=arguments.callee.callStack,e=0;e<t.length&&!1!==t[e].apply(this,arguments);e++);if(n)try{this[i]=null}catch(t){}}return t.callStack=[],t},addToCallStack:function(t,e,i,n){var o=MochiKit.DOM,r=t[e],s=r;"function"==typeof r&&"object"==typeof r.callStack&&null!==r.callStack||(s=o._newCallStack(e,n),"function"==typeof r&&s.callStack.push(r),t[e]=s),s.callStack.push(i)},addLoadEvent:function(t){var e=MochiKit.DOM;e.addToCallStack(e._window,"onload",t,!0)},focusOnLoad:function(t){var e=MochiKit.DOM;e.addLoadEvent(function(){(t=e.getElement(t))&&t.focus()})},setElementClass:function(t,e){var i=MochiKit.DOM,n=i.getElement(t);i.attributeArray.compliant?n.setAttribute("class",e):n.setAttribute("className",e)},toggleElementClass:function(t){for(var e=MochiKit.DOM,i=1;i<arguments.length;i++){var n=e.getElement(arguments[i]);e.addElementClass(n,t)||e.removeElementClass(n,t)}},addElementClass:function(t,e){var i=MochiKit.DOM,n=i.getElement(t),o=n.className;if("string"!=typeof o&&(o=n.getAttribute("class")),"string"!=typeof o||0===o.length)return i.setElementClass(n,e),!0;if(o==e)return!1;for(var r=o.split(" "),s=0;s<r.length;s++)if(r[s]==e)return!1;return i.setElementClass(n,o+" "+e),!0},removeElementClass:function(t,e){var i=MochiKit.DOM,n=i.getElement(t),o=n.className;if("string"!=typeof o&&(o=n.getAttribute("class")),"string"!=typeof o||0===o.length)return!1;if(o==e)return i.setElementClass(n,""),!0;for(var r=o.split(" "),s=0;s<r.length;s++)if(r[s]==e)return r.splice(s,1),i.setElementClass(n,r.join(" ")),!0;return!1},swapElementClass:function(t,e,i){var n=MochiKit.DOM.getElement(t),o=MochiKit.DOM.removeElementClass(n,e);return o&&MochiKit.DOM.addElementClass(n,i),o},hasElementClass:function(t,e){var i=MochiKit.DOM.getElement(t);if(null==i)return!1;var n=i.className;if("string"!=typeof n&&(n=i.getAttribute("class")),"string"!=typeof n)return!1;for(var o=n.split(" "),r=1;r<arguments.length;r++){for(var s=!1,a=0;a<o.length;a++)if(o[a]==arguments[r]){s=!0;break}if(!s)return!1}return!0},escapeHTML:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(t){return MochiKit.DOM.emitHTML(t).join("")},emitHTML:function(t,e){null==e&&(e=[]);for(var i=[t],n=MochiKit.DOM,o=n.escapeHTML,r=n.attributeArray;i.length;)if("string"==typeof(t=i.pop()))e.push(t);else if(1==t.nodeType){e.push("<"+t.tagName.toLowerCase());for(var s=[],a=r(t),l=0;l<a.length;l++){var c=a[l];s.push([" ",c.name,'="',o(c.value),'"'])}for(s.sort(),l=0;l<s.length;l++)for(var h=s[l],u=0;u<h.length;u++)e.push(h[u]);if(t.hasChildNodes()){e.push(">"),i.push("</"+t.tagName.toLowerCase()+">");var f=t.childNodes;for(l=f.length-1;0<=l;l--)i.push(f[l])}else e.push("/>")}else 3==t.nodeType&&e.push(o(t.nodeValue));return e},scrapeText:function(t,e){var o=[];return function(t){var e=t.childNodes;if(e)for(var i=0;i<e.length;i++)arguments.callee.call(this,e[i]);var n=t.nodeValue;"string"==typeof n&&o.push(n)}(MochiKit.DOM.getElement(t)),e?o:o.join("")},removeEmptyTextNodes:function(t){t=MochiKit.DOM.getElement(t);for(var e=0;e<t.childNodes.length;e++){var i=t.childNodes[e];3!=i.nodeType||/\S/.test(i.nodeValue)||i.parentNode.removeChild(i)}},getFirstElementByTagAndClassName:function(t,e,i){var n=MochiKit.DOM;if(null==t&&(t="*"),null==i&&(i=n._document),null==(i=n.getElement(i)))return null;var o=i.getElementsByTagName(t)||n._document.all;if(o.length<=0)return null;if(null==e)return o[0];for(var r=0;r<o.length;r++){var s=o[r],a=s.className;if("string"!=typeof a&&(a=s.getAttribute("class")),"string"==typeof a)for(var l=a.split(" "),c=0;c<l.length;c++)if(l[c]==e)return s}return null},getFirstParentByTagAndClassName:function(t,e,i){var n=MochiKit.DOM;for(t=n.getElement(t),e=null==e?"*":e.toUpperCase(),null==i&&(i=null),t=t&&t.parentNode;t&&t.tagName;){var o=t.tagName.toUpperCase();if(("*"===e||e==o)&&(null===i||n.hasElementClass(t,i)))return t;t=t.parentNode}return null},__new__:function(t){var e=MochiKit.Base;if("undefined"!=typeof document){this._document=document;this._xhtml=document.documentElement&&document.createElementNS&&"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"===document.documentElement.namespaceURI}else MochiKit.MockDOM&&(this._document=MochiKit.MockDOM.document);this._window=t,this.domConverters=new e.AdapterRegistry;var i,n=this._document.createElement("span");if(n&&n.attributes&&0<n.attributes.length){var o=e.filter;(i=function(t){return o(i.ignoreAttrFilter,t.attributes)}).ignoreAttr={};for(var r=n.attributes,s=i.ignoreAttr,a=0;a<r.length;a++){var l=r[a];s[l.name]=l.value}i.ignoreAttrFilter=function(t){return i.ignoreAttr[t.name]!=t.value},i.compliant=!1,i.renames={class:"className",checked:"defaultChecked",usemap:"useMap",for:"htmlFor",readonly:"readOnly",colspan:"colSpan",bgcolor:"bgColor",cellspacing:"cellSpacing",cellpadding:"cellPadding"}}else(i=function(t){return t.attributes}).compliant=!0,i.ignoreAttr={},i.renames={};this.attributeArray=i;var c,h,u,f,p,d;for(a=0;a<MochiKit.DOM.DEPRECATED.length;a++)c="DOM",h=MochiKit.DOM.DEPRECATED[a],d=f=void 0,u=h[0],f=h[1],p=f.split(".")[1],d="",d+="if (!MochiKit."+p+') { throw new Error("',d+="This function has been deprecated and depends on MochiKit.",d+=p+'.");}',d+="return "+f+".apply(this, arguments);",MochiKit[c][u]=new Function(d);var g=this.createDOMFunc;this.UL=g("ul"),this.OL=g("ol"),this.LI=g("li"),this.DL=g("dl"),this.DT=g("dt"),this.DD=g("dd"),this.TD=g("td"),this.TR=g("tr"),this.TBODY=g("tbody"),this.THEAD=g("thead"),this.TFOOT=g("tfoot"),this.TABLE=g("table"),this.TH=g("th"),this.INPUT=g("input"),this.SPAN=g("span"),this.A=g("a"),this.DIV=g("div"),this.IMG=g("img"),this.BUTTON=g("button"),this.TT=g("tt"),this.PRE=g("pre"),this.H1=g("h1"),this.H2=g("h2"),this.H3=g("h3"),this.H4=g("h4"),this.H5=g("h5"),this.H6=g("h6"),this.BR=g("br"),this.HR=g("hr"),this.LABEL=g("label"),this.TEXTAREA=g("textarea"),this.FORM=g("form"),this.P=g("p"),this.SELECT=g("select"),this.OPTION=g("option"),this.OPTGROUP=g("optgroup"),this.LEGEND=g("legend"),this.FIELDSET=g("fieldset"),this.STRONG=g("strong"),this.CANVAS=g("canvas"),this.$=this.getElement,this.EXPORT_TAGS={":common":this.EXPORT,":all":e.concat(this.EXPORT,this.EXPORT_OK)},e.nameFunctions(this)}}),MochiKit.DOM.__new__("undefined"==typeof window?this:window),MochiKit.__export__&&(withWindow=MochiKit.DOM.withWindow,withDocument=MochiKit.DOM.withDocument),MochiKit.Base._exportSymbols(this,MochiKit.DOM),MochiKit.Base._deps("Selector",["Base","DOM","Iter"]),MochiKit.Selector.NAME="MochiKit.Selector",MochiKit.Selector.VERSION="1.4.2",MochiKit.Selector.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Selector.toString=function(){return this.__repr__()},MochiKit.Selector.EXPORT=["Selector","findChildElements","findDocElements","$$"],MochiKit.Selector.EXPORT_OK=[],MochiKit.Selector.Selector=function(t){this.params={classNames:[],pseudoClassNames:[]},this.expression=t.toString().replace(/(^\s+|\s+$)/g,""),this.parseExpression(),this.compileMatcher()},MochiKit.Selector.Selector.prototype={__class__:MochiKit.Selector.Selector,parseExpression:function(){function t(t){throw"Parse error in selector: "+t}""==this.expression&&t("empty expression");for(var e,i,n,o,r=MochiKit.Base.repr,s=this.params,a=this.expression;e=a.match(/^(.*)\[([a-z0-9_:-]+?)(?:([~\|!^$*]?=)(?:"([^"]*)"|([^\]\s]*)))?\]$/i);)s.attributes=s.attributes||[],s.attributes.push({name:e[2],operator:e[3],value:e[4]||e[5]||""}),a=e[1];if("*"==a)return this.params.wildcard=!0;for(;e=a.match(/^([^a-z0-9_-])?([a-z0-9_-]+(?:\([^)]*\))?)(.*)/i);){switch(i=e[1],n=e[2],o=e[3],i){case"#":s.id=n;break;case".":s.classNames.push(n);break;case":":s.pseudoClassNames.push(n);break;case"":case void 0:s.tagName=n.toUpperCase();break;default:t(r(a))}a=o}0<a.length&&t(r(a))},buildMatchExpression:function(){var t,e,n=MochiKit.Base.repr,i=this.params,o=[];function r(t){return"MochiKit.Base.filter(function (node) { return node.nodeType == 1; }, "+t+".childNodes)"}if(i.wildcard&&o.push("true"),(t=i.id)&&o.push("element.id == "+n(t)),(t=i.tagName)&&o.push("element.tagName.toUpperCase() == "+n(t)),0<(t=i.classNames).length)for(e=0;e<t.length;e++)o.push("MochiKit.DOM.hasElementClass(element, "+n(t[e])+")");if(0<(t=i.pseudoClassNames).length)for(e=0;e<t.length;e++){var s=t[e].match(/^([^(]+)(?:\((.*)\))?$/),a=s[1],l=s[2];switch(a){case"root":o.push("element.nodeType == 9 || element === element.ownerDocument.documentElement");break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":if(!(s=l.match(/^((?:(\d+)n\+)?(\d+)|odd|even)$/)))throw"Invalid argument to pseudo element nth-child: "+l;var c,h;h="odd"==s[0]?(c=2,1):"even"==s[0]?(c=2,0):(c=s[2]&&parseInt(s)||null,parseInt(s[3])),o.push("this.nthChild(element,"+c+","+h+","+!!a.match("^nth-last")+","+!!a.match("of-type$")+")");break;case"first-child":o.push("this.nthChild(element, null, 1)");break;case"last-child":o.push("this.nthChild(element, null, 1, true)");break;case"first-of-type":o.push("this.nthChild(element, null, 1, false, true)");break;case"last-of-type":o.push("this.nthChild(element, null, 1, true, true)");break;case"only-child":o.push(r("element.parentNode")+".length == 1");break;case"only-of-type":o.push("MochiKit.Base.filter(function (node) { return node.tagName == element.tagName; }, "+r("element.parentNode")+").length == 1");break;case"empty":o.push("element.childNodes.length == 0");break;case"enabled":o.push("(this.isUIElement(element) && element.disabled === false)");break;case"disabled":o.push("(this.isUIElement(element) && element.disabled === true)");break;case"checked":o.push("(this.isUIElement(element) && element.checked === true)");break;case"not":var u=new MochiKit.Selector.Selector(l);o.push("!( "+u.buildMatchExpression()+")")}}return(t=i.attributes)&&MochiKit.Base.map(function(t){function e(t){return i+".split("+n(t)+")"}var i="MochiKit.DOM.getNodeAttribute(element, "+n(t.name)+")";switch(o.push(i+" != null"),t.operator){case"=":o.push(i+" == "+n(t.value));break;case"~=":o.push("MochiKit.Base.findValue("+e(" ")+", "+n(t.value)+") > -1");break;case"^=":o.push(i+".substring(0, "+t.value.length+") == "+n(t.value));break;case"$=":o.push(i+".substring("+i+".length - "+t.value.length+") == "+n(t.value));break;case"*=":o.push(i+".match("+n(t.value)+")");break;case"|=":o.push(e("-")+"[0].toUpperCase() == "+n(t.value.toUpperCase()));break;case"!=":o.push(i+" != "+n(t.value));break;case"":case void 0:break;default:throw"Unknown operator "+t.operator+" in selector"}},t),o.join(" && ")},compileMatcher:function(){var t="return (!element.tagName) ? false : "+this.buildMatchExpression()+";";this.match=new Function("element",t)},nthChild:function(e,t,i,n,o){var r=MochiKit.Base.filter(function(t){return 1==t.nodeType},e.parentNode.childNodes);return o&&(r=MochiKit.Base.filter(function(t){return t.tagName==e.tagName},r)),n&&(r=MochiKit.Iter.reversed(r)),t?(MochiKit.Base.findIdentical(r,e)+1-i)/t%1==0:i==MochiKit.Base.findIdentical(r,e)+1},isUIElement:function(t){return-1<MochiKit.Base.findValue(["input","button","select","option","textarea","object"],t.tagName.toLowerCase())},findElements:function(t,n){var e;if(null==n&&(n=""),(e=MochiKit.DOM.getElement(this.params.id))&&this.match(e)&&(!t||function(t,e){if(""==n)return MochiKit.DOM.isChildNode(t,e);if(">"==n)return t.parentNode===e;if("+"==n)return t===o(e);if("~"!=n)throw"Invalid axis: "+n;for(var i=e;i=o(i);)if(t===i)return 1}(e,t)))return[e];function o(t){for(t=t.nextSibling;t&&1!=t.nodeType;)t=t.nextSibling;return t}if(""==n)t=(t||MochiKit.DOM.currentDocument()).getElementsByTagName(this.params.tagName||"*");else if(">"==n){if(!t)throw"> combinator not allowed without preceeding expression";t=MochiKit.Base.filter(function(t){return 1==t.nodeType},t.childNodes)}else if("+"==n){if(!t)throw"+ combinator not allowed without preceeding expression";t=o(t)&&[o(t)]}else if("~"==n){if(!t)throw"~ combinator not allowed without preceeding expression";for(var i=[];o(t);)t=o(t),i.push(t);t=i}return t?MochiKit.Base.filter(MochiKit.Base.bind(function(t){return this.match(t)},this),t):[]},repr:function(){return"Selector("+this.expression+")"},toString:MochiKit.Base.forwardCall("repr")},MochiKit.Base.update(MochiKit.Selector,{findChildElements:function(r,t){return MochiKit.Base.flattenArray(MochiKit.Base.map(function(t){var o="",e=t.replace(/(^\s+|\s+$)/g,"").split(/\s+/);return function(t){for(var e=[],i=0;i<t.length;i++)MochiKit.Base.findIdentical(e,t[i])<0&&e.push(t[i]);return e}(MochiKit.Iter.reduce(function(t,e){if(match=e.match(/^[>+~]$/))return o=match[0],t;var i=new MochiKit.Selector.Selector(e),n=MochiKit.Iter.reduce(function(t,e){return MochiKit.Base.extend(t,i.findElements(e||r,o))},t,[]);return o="",n},e,[null]))},t))},findDocElements:function(){return MochiKit.Selector.findChildElements(MochiKit.DOM.currentDocument(),arguments)},__new__:function(){var t=MochiKit.Base;this.$$=this.findDocElements,this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)},t.nameFunctions(this)}}),MochiKit.Selector.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Selector),MochiKit.Base._deps("Style",["Base","DOM"]),MochiKit.Style.NAME="MochiKit.Style",MochiKit.Style.VERSION="1.4.2",MochiKit.Style.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Style.toString=function(){return this.__repr__()},MochiKit.Style.EXPORT_OK=[],MochiKit.Style.EXPORT=["setStyle","setOpacity","getStyle","getElementDimensions","elementDimensions","setElementDimensions","getElementPosition","elementPosition","setElementPosition","makePositioned","undoPositioned","makeClipping","undoClipping","setDisplayForElement","hideElement","showElement","getViewportDimensions","getViewportPosition","Dimensions","Coordinates"],MochiKit.Style.Dimensions=function(t,e){this.w=t,this.h=e},MochiKit.Style.Dimensions.prototype.__repr__=function(){var t=MochiKit.Base.repr;return"{w: "+t(this.w)+", h: "+t(this.h)+"}"},MochiKit.Style.Dimensions.prototype.toString=function(){return this.__repr__()},MochiKit.Style.Coordinates=function(t,e){this.x=t,this.y=e},MochiKit.Style.Coordinates.prototype.__repr__=function(){var t=MochiKit.Base.repr;return"{x: "+t(this.x)+", y: "+t(this.y)+"}"},MochiKit.Style.Coordinates.prototype.toString=function(){return this.__repr__()},MochiKit.Base.update(MochiKit.Style,{getStyle:function(t,e){var i=MochiKit.DOM,n=i._document;if(t=i.getElement(t),e=MochiKit.Base.camelize(e),t&&t!=n){if("opacity"==e&&void 0!==t.filters){var o=(MochiKit.Style.getStyle(t,"filter")||"").match(/alpha\(opacity=(.*)\)/);return o&&o[1]?parseFloat(o[1])/100:1}if("float"==e||"cssFloat"==e||"styleFloat"==e)return t.style.float?t.style.float:t.style.cssFloat?t.style.cssFloat:t.style.styleFloat?t.style.styleFloat:"none";var r=t.style?t.style[e]:null;if(!r)if(n.defaultView&&n.defaultView.getComputedStyle){var s=n.defaultView.getComputedStyle(t,null);e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),r=s?s.getPropertyValue(e):null}else if(t.currentStyle&&(r=t.currentStyle[e],/^\d/.test(r)&&!/px$/.test(r)&&"fontWeight"!=e)){var a=t.style.left,l=t.runtimeStyle.left;t.runtimeStyle.left=t.currentStyle.left,t.style.left=r||0,r=t.style.pixelLeft+"px",t.style.left=a,t.runtimeStyle.left=l}return"opacity"==e&&(r=parseFloat(r)),/Opera/.test(navigator.userAgent)&&-1!=MochiKit.Base.findValue(["left","top","right","bottom"],e)&&"static"==MochiKit.Style.getStyle(t,"position")&&(r="auto"),"auto"==r?null:r}},setStyle:function(t,e){for(var i in t=MochiKit.DOM.getElement(t),e)switch(i){case"opacity":MochiKit.Style.setOpacity(t,e[i]);break;case"float":case"cssFloat":case"styleFloat":void 0!==t.style.float?t.style.float=e[i]:void 0!==t.style.cssFloat?t.style.cssFloat=e[i]:t.style.styleFloat=e[i];break;default:t.style[MochiKit.Base.camelize(i)]=e[i]}},setOpacity:function(t,e){t=MochiKit.DOM.getElement(t);var i=MochiKit.Style;if(1==e){var n=/Gecko/.test(navigator.userAgent)&&!/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent);t.style.opacity=n?.999999:1,/MSIE/.test(navigator.userAgent)&&(t.style.filter=i.getStyle(t,"filter").replace(/alpha\([^\)]*\)/gi,""))}else e<1e-5&&(e=0),t.style.opacity=e,/MSIE/.test(navigator.userAgent)&&(t.style.filter=i.getStyle(t,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+100*e+")")},getElementPosition:function(t,e){var i=MochiKit.Style;if((t=MochiKit.DOM.getElement(t))&&(t.x&&t.y||null!==!t.parentNode&&"none"!=i.getStyle(t,"display"))){var n=new i.Coordinates(0,0),o=null,r=null,s=MochiKit.DOM._document,a=s.documentElement,l=s.body;if(!t.parentNode&&t.x&&t.y)n.x+=t.x||0,n.y+=t.y||0;else if(t.getBoundingClientRect)o=t.getBoundingClientRect(),n.x+=o.left+(a.scrollLeft||l.scrollLeft)-(a.clientLeft||0),n.y+=o.top+(a.scrollTop||l.scrollTop)-(a.clientTop||0);else if(t.offsetParent){if(n.x+=t.offsetLeft,n.y+=t.offsetTop,(r=t.offsetParent)!=t)for(;r;)n.x+=parseInt(r.style.borderLeftWidth)||0,n.y+=parseInt(r.style.borderTopWidth)||0,n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;var c=navigator.userAgent.toLowerCase();for(("undefined"!=typeof opera&&parseFloat(opera.version())<9||-1!=c.indexOf("AppleWebKit")&&"absolute"==i.getStyle(t,"position"))&&(n.x-=l.offsetLeft,n.y-=l.offsetTop),r=t.parentNode?t.parentNode:null;r;){var h=r.tagName.toUpperCase();if("BODY"===h||"HTML"===h)break;i.getStyle(r,"display").search(/^inline|table-row.*$/i)&&(n.x-=r.scrollLeft,n.y-=r.scrollTop),r=r.parentNode?r.parentNode:null}}return void 0!==e&&(e=arguments.callee(e))&&(n.x-=e.x||0,n.y-=e.y||0),n}},setElementPosition:function(t,e,i){t=MochiKit.DOM.getElement(t),void 0===i&&(i="px");var n={},o=MochiKit.Base.isUndefinedOrNull;o(e.x)||(n.left=e.x+i),o(e.y)||(n.top=e.y+i),MochiKit.DOM.updateNodeAttributes(t,{style:n})},makePositioned:function(t){t=MochiKit.DOM.getElement(t);var e=MochiKit.Style.getStyle(t,"position");"static"!=e&&e||(t.style.position="relative",/Opera/.test(navigator.userAgent)&&(t.style.top=0,t.style.left=0))},undoPositioned:function(t){"relative"==(t=MochiKit.DOM.getElement(t)).style.position&&(t.style.position=t.style.top=t.style.left=t.style.bottom=t.style.right="")},makeClipping:function(t){var e=(t=MochiKit.DOM.getElement(t)).style,i={overflow:e.overflow,"overflow-x":e.overflowX,"overflow-y":e.overflowY};return"hidden"!=(MochiKit.Style.getStyle(t,"overflow")||"visible")&&(t.style.overflow="hidden",t.style.overflowX="hidden",t.style.overflowY="hidden"),i},undoClipping:function(t,e){t=MochiKit.DOM.getElement(t),"string"==typeof e?t.style.overflow=e:null!=e&&(t.style.overflow=e.overflow,t.style.overflowX=e["overflow-x"],t.style.overflowY=e["overflow-y"])},getElementDimensions:function(t,e){var i=MochiKit.Style,n=MochiKit.DOM;if("number"==typeof t.w||"number"==typeof t.h)return new i.Dimensions(t.w||0,t.h||0);if(t=n.getElement(t)){var o=i.getStyle(t,"display");if("none"==o||""==o||void 0===o){var r=t.style,s=r.visibility,a=r.position,l=r.display;r.visibility="hidden",r.position="absolute",r.display=i._getDefaultDisplay(t);var c=t.offsetWidth,h=t.offsetHeight;r.display=l,r.position=a,r.visibility=s}else c=t.offsetWidth||0,h=t.offsetHeight||0;if(e){var u="colSpan"in t&&"rowSpan"in t,f=u&&t.parentNode&&"collapse"==i.getStyle(t.parentNode,"borderCollapse");if(f)if(/MSIE/.test(navigator.userAgent))var p=t.previousSibling?.5:1,d=t.nextSibling?.5:1;else p=.5,d=.5;else p=1,d=1;if(c-=Math.round((parseFloat(i.getStyle(t,"paddingLeft"))||0)+(parseFloat(i.getStyle(t,"paddingRight"))||0)+p*(parseFloat(i.getStyle(t,"borderLeftWidth"))||0)+d*(parseFloat(i.getStyle(t,"borderRightWidth"))||0)),u)if(/Gecko|Opera/.test(navigator.userAgent)&&!/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent))var g=0;else if(/MSIE/.test(navigator.userAgent))g=1;else g=f?.5:1;else g=1;h-=Math.round((parseFloat(i.getStyle(t,"paddingTop"))||0)+(parseFloat(i.getStyle(t,"paddingBottom"))||0)+g*((parseFloat(i.getStyle(t,"borderTopWidth"))||0)+(parseFloat(i.getStyle(t,"borderBottomWidth"))||0)))}return new i.Dimensions(c,h)}},setElementDimensions:function(t,e,i){t=MochiKit.DOM.getElement(t),void 0===i&&(i="px");var n={},o=MochiKit.Base.isUndefinedOrNull;o(e.w)||(n.width=e.w+i),o(e.h)||(n.height=e.h+i),MochiKit.DOM.updateNodeAttributes(t,{style:n})},_getDefaultDisplay:function(t){var e=MochiKit.Style;if(t=MochiKit.DOM.getElement(t)){var i=t.tagName.toUpperCase();return e._defaultDisplay[i]||"block"}},setDisplayForElement:function(t,e){for(var i=MochiKit.Base.extend(null,arguments,1),n=MochiKit.DOM.getElement,o=0;o<i.length;o++)(e=n(i[o]))&&(e.style.display=t)},getViewportDimensions:function(){var t=new MochiKit.Style.Dimensions,e=MochiKit.DOM._window,i=MochiKit.DOM._document.body;return e.innerWidth?(t.w=e.innerWidth,t.h=e.innerHeight):i&&i.parentElement&&i.parentElement.clientWidth?(t.w=i.parentElement.clientWidth,t.h=i.parentElement.clientHeight):i&&i.clientWidth&&(t.w=i.clientWidth,t.h=i.clientHeight),t},getViewportPosition:function(){var t=new MochiKit.Style.Coordinates(0,0),e=MochiKit.DOM._document,i=e.documentElement,n=e.body;return i&&(i.scrollTop||i.scrollLeft)?(t.x=i.scrollLeft,t.y=i.scrollTop):n&&(t.x=n.scrollLeft,t.y=n.scrollTop),t},__new__:function(){var t=MochiKit.Base,e=["A","ABBR","ACRONYM","B","BASEFONT","BDO","BIG","BR","CITE","CODE","DFN","EM","FONT","I","IMG","KBD","LABEL","Q","S","SAMP","SMALL","SPAN","STRIKE","STRONG","SUB","SUP","TEXTAREA","TT","U","VAR"];if(this._defaultDisplay={TABLE:"table",THEAD:"table-header-group",TBODY:"table-row-group",TFOOT:"table-footer-group",COLGROUP:"table-column-group",COL:"table-column",TR:"table-row",TD:"table-cell",TH:"table-cell",CAPTION:"table-caption",LI:"list-item",INPUT:"inline-block",SELECT:"inline-block"},/MSIE/.test(navigator.userAgent))for(var i in this._defaultDisplay){0==this._defaultDisplay[i].indexOf("table")&&(this._defaultDisplay[i]="block")}for(var n=0;n<e.length;n++)this._defaultDisplay[e[n]]="inline";this.elementPosition=this.getElementPosition,this.elementDimensions=this.getElementDimensions,this.hideElement=t.partial(this.setDisplayForElement,"none"),this.showElement=t.partial(this.setDisplayForElement,"block"),this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)},t.nameFunctions(this)}}),MochiKit.Style.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Style),MochiKit.Base._deps("LoggingPane",["Base","Logging"]),MochiKit.LoggingPane.NAME="MochiKit.LoggingPane",MochiKit.LoggingPane.VERSION="1.4.2",MochiKit.LoggingPane.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.LoggingPane.toString=function(){return this.__repr__()},MochiKit.LoggingPane.createLoggingPane=function(t){var e=MochiKit.LoggingPane;return t=!!t,e._loggingPane&&e._loggingPane.inline!=t&&(e._loggingPane.closePane(),e._loggingPane=null),e._loggingPane&&!e._loggingPane.closed||(e._loggingPane=new e.LoggingPane(t,MochiKit.Logging.logger)),e._loggingPane},MochiKit.LoggingPane.LoggingPane=function(t,e){null==e&&(e=MochiKit.Logging.logger),this.logger=e;MochiKit.Base.update;var i=MochiKit.Base.updatetree,n=MochiKit.Base.bind,o=MochiKit.Base.clone,r=window,s="_MochiKit_LoggingPane";if(void 0!==MochiKit.DOM&&(r=MochiKit.DOM.currentWindow()),!t){var a=s+"_"+r.location.href.split("?")[0].replace(/[#:\/.><&%-]/g,"_"),l=r.open("",a,"dependent,resizable,height=200");if(!l)return void alert("Not able to open debugging window due to pop-up blocking.");l.document.write('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>[MochiKit.LoggingPane]</title></head><body></body></html>'),l.document.close(),l.document.title+=" "+r.document.title,r=l}var c=r.document,h=(this.doc=c).getElementById(s),u=!!h;if(h&&void 0!==h.loggingPane)return h.loggingPane.logger=this.logger,h.loggingPane.buildAndApplyFilter(),h.loggingPane;if(u)for(var f;f=h.firstChild;)h.removeChild(f);else(h=c.createElement("div")).id=s;h.loggingPane=this;var p=c.createElement("input"),d=c.createElement("input"),g=c.createElement("button"),m=c.createElement("button"),M=c.createElement("button"),y=c.createElement("button"),K=c.createElement("div"),v=c.createElement("div"),_=s+"_Listener";this.colorTable=o(this.colorTable);function S(t){var e=t.level;return"number"==typeof e&&(e=MochiKit.Logging.LogLevel[e]),e}function b(t){return t.info.join(" ")}function E(t){D[D.length]=t,C(t)}function w(){for(;v.firstChild;)v.removeChild(v.firstChild)}function O(){w();for(var t=0;t<D.length;t++){var e=D[t];null!==T&&!T(e)||C(e)}}var D=[],T=null,C=n(function(t){var e=S(t),i=b(t),n=this.colorTable[e],o=c.createElement("span");o.className="MochiKit-LogMessage MochiKit-LogLevel-"+e,o.style.cssText="margin: 0px; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; white-space: pre-wrap; white-space: pre-line; word-wrap: break-word; wrap-option: emergency; color: "+n,o.appendChild(c.createTextNode(e+": "+i)),v.appendChild(o),v.appendChild(c.createElement("br")),K.offsetHeight>K.scrollHeight?K.scrollTop=0:K.scrollTop=K.scrollHeight},this),A=n(function(){if(!this.closed){this.closed=!0,MochiKit.LoggingPane._loggingPane==this&&(MochiKit.LoggingPane._loggingPane=null),this.logger.removeListener(_);try{try{h.loggingPane=null}catch(t){logFatal("Bookmarklet was closed incorrectly.")}t?h.parentNode.removeChild(h):this.win.close()}catch(t){}}},this);this.buildAndApplyFilter=function(){T=function(){var e,i;try{e=new RegExp(p.value),i=new RegExp(d.value)}catch(t){return logDebug("Error in filter regex: "+t.message),null}return function(t){return e.test(S(t))&&i.test(b(t))}}(),O(),this.logger.removeListener(_),this.logger.addListener(_,T,E)};var B=n(function(){D=this.logger.getMessages(),O()},this),x=n(function(t){t=t||window.event,key=t.which||t.keyCode,13==key&&this.buildAndApplyFilter()},this),N="display: block; z-index: 1000; left: 0px; bottom: 0px; position: fixed; width: 100%; background-color: white; font: "+this.logFont;return N+=t?"; height: 10em; border-top: 2px solid black":"; height: 100%;",h.style.cssText=N,u||c.body.appendChild(h),N={cssText:"width: 33%; display: inline; font: "+this.logFont},i(p,{value:"FATAL|ERROR|WARNING|INFO|DEBUG",onkeypress:x,style:N}),h.appendChild(p),i(d,{value:".*",onkeypress:x,style:N}),h.appendChild(d),N="width: 8%; display:inline; font: "+this.logFont,g.appendChild(c.createTextNode("Filter")),g.onclick=n("buildAndApplyFilter",this),g.style.cssText=N,h.appendChild(g),m.appendChild(c.createTextNode("Load")),m.onclick=B,m.style.cssText=N,h.appendChild(m),M.appendChild(c.createTextNode("Clear")),M.onclick=function(){D=[],w()},M.style.cssText=N,h.appendChild(M),y.appendChild(c.createTextNode("Close")),y.onclick=A,y.style.cssText=N,h.appendChild(y),K.style.cssText="overflow: auto; width: 100%",v.style.cssText="width: 100%; height: "+(t?"8em":"100%"),K.appendChild(v),h.appendChild(K),this.buildAndApplyFilter(),B(),this.win=t?void 0:r,this.inline=t,this.closePane=A,this.closed=!1,this},MochiKit.LoggingPane.LoggingPane.prototype={logFont:"8pt Verdana,sans-serif",colorTable:{ERROR:"red",FATAL:"darkred",WARNING:"blue",INFO:"black",DEBUG:"green"}},MochiKit.LoggingPane.EXPORT_OK=["LoggingPane"],MochiKit.LoggingPane.EXPORT=["createLoggingPane"],MochiKit.LoggingPane.__new__=function(){this.EXPORT_TAGS={":common":this.EXPORT,":all":MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)},MochiKit.Base.nameFunctions(this),MochiKit.LoggingPane._loggingPane=null},MochiKit.LoggingPane.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.LoggingPane),MochiKit.Base._deps("Color",["Base","DOM","Style"]),MochiKit.Color.NAME="MochiKit.Color",MochiKit.Color.VERSION="1.4.2",MochiKit.Color.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Color.toString=function(){return this.__repr__()},MochiKit.Color.Color=function(t,e,i,n){null==n&&(n=1),this.rgb={r:t,g:e,b:i,a:n}},MochiKit.Color.Color.prototype={__class__:MochiKit.Color.Color,colorWithAlpha:function(t){var e=this.rgb;return MochiKit.Color.Color.fromRGB(e.r,e.g,e.b,t)},colorWithHue:function(t){var e=this.asHSL();return e.h=t,MochiKit.Color.Color.fromHSL(e)},colorWithSaturation:function(t){var e=this.asHSL();return e.s=t,MochiKit.Color.Color.fromHSL(e)},colorWithLightness:function(t){var e=this.asHSL();return e.l=t,MochiKit.Color.Color.fromHSL(e)},darkerColorWithLevel:function(t){var e=this.asHSL();return e.l=Math.max(e.l-t,0),MochiKit.Color.Color.fromHSL(e)},lighterColorWithLevel:function(t){var e=this.asHSL();return e.l=Math.min(e.l+t,1),MochiKit.Color.Color.fromHSL(e)},blendedColor:function(t,e){null==e&&(e=.5);var i=1-e,n=this.rgb,o=t.rgb;return MochiKit.Color.Color.fromRGB(n.r*i+o.r*e,n.g*i+o.g*e,n.b*i+o.b*e,n.a*i+o.a*e)},compareRGB:function(t){var e=this.asRGB(),i=t.asRGB();return MochiKit.Base.compare([e.r,e.g,e.b,e.a],[i.r,i.g,i.b,i.a])},isLight:function(){return.5<this.asHSL().b},isDark:function(){return!this.isLight()},toHSLString:function(){var t=this.asHSL(),e=MochiKit.Color.clampColorComponent,i=this._hslString;if(!i){var n=e(t.h,360).toFixed(0)+","+e(t.s,100).toPrecision(4)+"%,"+e(t.l,100).toPrecision(4)+"%",o=t.a;i=1<=o?(o=1,"hsl("+n+")"):(o<=0&&(o=0),"hsla("+n+","+o+")"),this._hslString=i}return i},toRGBString:function(){var t=this.rgb,e=MochiKit.Color.clampColorComponent,i=this._rgbString;if(!i){var n=e(t.r,255).toFixed(0)+","+e(t.g,255).toFixed(0)+","+e(t.b,255).toFixed(0);i=1!=t.a?"rgba("+n+","+t.a+")":"rgb("+n+")",this._rgbString=i}return i},asRGB:function(){return MochiKit.Base.clone(this.rgb)},toHexString:function(){var t=MochiKit.Color,e=this.rgb,i=MochiKit.Color.clampColorComponent,n=this._hexString;return n||(n="#"+t.toColorPart(i(e.r,255))+t.toColorPart(i(e.g,255))+t.toColorPart(i(e.b,255)),this._hexString=n),n},asHSV:function(){var t=this.hsv;this.rgb;return null==t&&(t=MochiKit.Color.rgbToHSV(this.rgb),this.hsv=t),MochiKit.Base.clone(t)},asHSL:function(){var t=this.hsl;this.rgb;return null==t&&(t=MochiKit.Color.rgbToHSL(this.rgb),this.hsl=t),MochiKit.Base.clone(t)},toString:function(){return this.toRGBString()},repr:function(){var t=this.rgb,e=[t.r,t.g,t.b,t.a];return this.__class__.NAME+"("+e.join(", ")+")"}},MochiKit.Base.update(MochiKit.Color.Color,{fromRGB:function(t,e,i,n){var o=MochiKit.Color.Color;if(1==arguments.length){var r=t;t=r.r,e=r.g,i=r.b,n=void 0===r.a?void 0:r.a}return new o(t,e,i,n)},fromHSL:function(t,e,i,n){var o=MochiKit.Color;return o.Color.fromRGB(o.hslToRGB.apply(o,arguments))},fromHSV:function(t,e,i,n){var o=MochiKit.Color;return o.Color.fromRGB(o.hsvToRGB.apply(o,arguments))},fromName:function(t){var e=MochiKit.Color.Color;'"'==t.charAt(0)&&(t=t.substr(1,t.length-2));var i=e._namedColors[t.toLowerCase()];return"string"==typeof i?e.fromHexString(i):"transparent"==t?e.transparentColor():null},fromString:function(t){var e=MochiKit.Color.Color,i=t.substr(0,3);return"rgb"==i?e.fromRGBString(t):"hsl"==i?e.fromHSLString(t):"#"==t.charAt(0)?e.fromHexString(t):e.fromName(t)},fromHexString:function(t){"#"==t.charAt(0)&&(t=t.substring(1));var e,i,n=[];if(3==t.length)for(e=0;e<3;e++)i=t.substr(e,1),n.push(parseInt(i+i,16)/255);else for(e=0;e<6;e+=2)i=t.substr(e,2),n.push(parseInt(i,16)/255);var o=MochiKit.Color.Color;return o.fromRGB.apply(o,n)},_fromColorString:function(t,e,i,n){0===n.indexOf(t)&&(n=n.substring(n.indexOf("(",3)+1,n.length-1));for(var o=n.split(/\s*,\s*/),r=[],s=0;s<o.length;s++){var a,l=o[s],c=l.substring(l.length-3);a="%"==l.charAt(l.length-1)?.01*parseFloat(l.substring(0,l.length-1)):"deg"==c?parseFloat(l)/360:"rad"==c?parseFloat(l)/(2*Math.PI):i[s]*parseFloat(l),r.push(a)}return this[e].apply(this,r)},fromComputedStyle:function(t,e){var i=MochiKit.DOM,n=MochiKit.Color.Color;for(t=i.getElement(t);t;t=t.parentNode){var o=MochiKit.Style.getStyle.apply(i,arguments);if(o){var r=n.fromString(o);if(!r)break;if(0<r.asRGB().a)return r}}return null},fromBackground:function(t){var e=MochiKit.Color.Color;return e.fromComputedStyle(t,"backgroundColor","background-color")||e.whiteColor()},fromText:function(t){var e=MochiKit.Color.Color;return e.fromComputedStyle(t,"color","color")||e.blackColor()},namedColors:function(){return MochiKit.Base.clone(MochiKit.Color.Color._namedColors)}}),MochiKit.Base.update(MochiKit.Color,{clampColorComponent:function(t,e){return(t*=e)<0?0:e<t?e:t},_hslValue:function(t,e,i){return 6<i?i-=6:i<0&&(i+=6),i<1?t+(e-t)*i:i<3?e:i<4?t+(e-t)*(4-i):t},hsvToRGB:function(t,e,i,n){if(1==arguments.length){var o=t;t=o.h,e=o.s,i=o.v,n=o.a}var r,s,a;if(0===e)a=s=r=i;else{var l=Math.floor(6*t),c=6*t-l,h=i*(1-e),u=i*(1-e*c),f=i*(1-e*(1-c));switch(l){case 1:r=u,s=i,a=h;break;case 2:r=h,s=i,a=f;break;case 3:r=h,s=u,a=i;break;case 4:r=f,s=h,a=i;break;case 5:r=i,s=h,a=u;break;case 6:case 0:r=i,s=f,a=h}}return{r:r,g:s,b:a,a:n}},hslToRGB:function(t,e,i,n){if(1==arguments.length){var o=t;t=o.h,e=o.s,i=o.l,n=o.a}var r,s,a;if(0===e)a=s=r=i;else{var l,c=2*i-(l=i<=.5?i*(1+e):i+e-i*e),h=MochiKit.Color._hslValue,u=6*t;r=h(c,l,2+u),s=h(c,l,u),a=h(c,l,u-2)}return{r:r,g:s,b:a,a:n}},rgbToHSV:function(t,e,i,n){if(1==arguments.length){var o=t;t=o.r,e=o.g,i=o.b,n=o.a}var r,s,a=Math.max(Math.max(t,e),i),l=Math.min(Math.min(t,e),i);if(l==a)s=r=0;else{var c=a-l;s=c/a,r=t==a?(e-i)/c:e==a?2+(i-t)/c:4+(t-e)/c,(r/=6)<0&&(r+=1),1<r&&--r}return{h:r,s:s,v:a,a:n}},rgbToHSL:function(t,e,i,n){if(1==arguments.length){var o=t;t=o.r,e=o.g,i=o.b,n=o.a}var r,s,a=Math.max(t,Math.max(e,i)),l=Math.min(t,Math.min(e,i)),c=(a+l)/2,h=a-l;return 0==h?s=r=0:(s=c<=.5?h/(a+l):h/(2-a-l),r=t==a?(e-i)/h:e==a?2+(i-t)/h:4+(t-e)/h,(r/=6)<0&&(r+=1),1<r&&--r),{h:r,s:s,l:c,a:n}},toColorPart:function(t){var e=(t=Math.round(t)).toString(16);return t<16?"0"+e:e},__new__:function(){var t=MochiKit.Base;this.Color.fromRGBString=t.bind(this.Color._fromColorString,this.Color,"rgb","fromRGB",[1/255,1/255,1/255,1]),this.Color.fromHSLString=t.bind(this.Color._fromColorString,this.Color,"hsl","fromHSL",[1/360,.01,.01,1]);function e(t,e,i,n,o){var r=this.fromRGB(e,i,n,o);return this[t]=function(){return r},r}var i={black:[0,0,0],blue:[0,0,1],brown:[.6,.4,.2],cyan:[0,1,1],darkGray:[1/3,1/3,1/3],gray:[.5,.5,.5],green:[0,1,0],lightGray:[1/3*2,1/3*2,1/3*2],magenta:[1,0,1],orange:[1,.5,0],purple:[.5,0,.5],red:[1,0,0],transparent:[0,0,0,0],white:[1,1,1],yellow:[1,1,0]};for(var n in i){var o=n+"Color",r=t.concat([e,this.Color,o],i[n]);this.Color[o]=t.bind.apply(null,r)}t.nameFunctions(this),t.registerComparator(this.Color.NAME,function(){for(var t=0;t<arguments.length;t++)if(!(arguments[t]instanceof MochiKit.Color.Color))return!1;return!0},function(t,e){return t.compareRGB(e)}),this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)}}}),MochiKit.Color.EXPORT=["Color"],MochiKit.Color.EXPORT_OK=["clampColorComponent","rgbToHSL","hslToRGB","rgbToHSV","hsvToRGB","toColorPart"],MochiKit.Color.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Color),MochiKit.Color.Color._namedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},MochiKit.Base._deps("Signal",["Base","DOM","Style"]),MochiKit.Signal.NAME="MochiKit.Signal",MochiKit.Signal.VERSION="1.4.2",MochiKit.Signal._observers=[],MochiKit.Signal.Event=function(t,e){this._event=e||window.event,this._src=t},MochiKit.Base.update(MochiKit.Signal.Event.prototype,{__repr__:function(){var t=MochiKit.Base.repr,e="{event(): "+t(this.event())+", src(): "+t(this.src())+", type(): "+t(this.type())+", target(): "+t(this.target());return(this.type()&&0===this.type().indexOf("key")||0===this.type().indexOf("mouse")||-1!=this.type().indexOf("click")||"contextmenu"==this.type())&&(e+=", modifier(): {alt: "+t(this.modifier().alt)+", ctrl: "+t(this.modifier().ctrl)+", meta: "+t(this.modifier().meta)+", shift: "+t(this.modifier().shift)+", any: "+t(this.modifier().any)+"}"),this.type()&&0===this.type().indexOf("key")&&(e+=", key(): {code: "+t(this.key().code)+", string: "+t(this.key().string)+"}"),!this.type()||0!==this.type().indexOf("mouse")&&-1==this.type().indexOf("click")&&"contextmenu"!=this.type()||(e+=", mouse(): {page: "+t(this.mouse().page)+", client: "+t(this.mouse().client),"mousemove"!=this.type()&&"mousewheel"!=this.type()&&(e+=", button: {left: "+t(this.mouse().button.left)+", middle: "+t(this.mouse().button.middle)+", right: "+t(this.mouse().button.right)+"}"),"mousewheel"==this.type()&&(e+=", wheel: "+t(this.mouse().wheel)),e+="}"),"mouseover"!=this.type()&&"mouseout"!=this.type()&&"mouseenter"!=this.type()&&"mouseleave"!=this.type()||(e+=", relatedTarget(): "+t(this.relatedTarget())),e+="}"},toString:function(){return this.__repr__()},src:function(){return this._src},event:function(){return this._event},type:function(){return"DOMMouseScroll"===this._event.type?"mousewheel":this._event.type||void 0},target:function(){return this._event.target||this._event.srcElement},_relatedTarget:null,relatedTarget:function(){if(null!==this._relatedTarget)return this._relatedTarget;var t=null;"mouseover"==this.type()||"mouseenter"==this.type()?t=this._event.relatedTarget||this._event.fromElement:"mouseout"!=this.type()&&"mouseleave"!=this.type()||(t=this._event.relatedTarget||this._event.toElement);try{if(null!==t&&null!==t.nodeType)return this._relatedTarget=t}catch(t){}},_modifier:null,modifier:function(){if(null!==this._modifier)return this._modifier;var t={};return t.alt=this._event.altKey,t.ctrl=this._event.ctrlKey,t.meta=this._event.metaKey||!1,t.shift=this._event.shiftKey,t.any=t.alt||t.ctrl||t.shift||t.meta,this._modifier=t},_key:null,key:function(){if(null!==this._key)return this._key;var t={};if(this.type()&&0===this.type().indexOf("key")){if("keydown"==this.type()||"keyup"==this.type())return t.code=this._event.keyCode,t.string=MochiKit.Signal._specialKeys[t.code]||"KEY_UNKNOWN",this._key=t;if("keypress"==this.type())return t.code=0,t.string="",void 0===this._event.charCode||0===this._event.charCode||MochiKit.Signal._specialMacKeys[this._event.charCode]?this._event.keyCode&&void 0===this._event.charCode&&(t.code=this._event.keyCode,t.string=String.fromCharCode(t.code)):(t.code=this._event.charCode,t.string=String.fromCharCode(t.code)),this._key=t}},_mouse:null,mouse:function(){if(null!==this._mouse)return this._mouse;var t={},e=this._event;if(this.type()&&(0===this.type().indexOf("mouse")||-1!=this.type().indexOf("click")||"contextmenu"==this.type())){if(t.client=new MochiKit.Style.Coordinates(0,0),(e.clientX||e.clientY)&&(t.client.x=!e.clientX||e.clientX<0?0:e.clientX,t.client.y=!e.clientY||e.clientY<0?0:e.clientY),t.page=new MochiKit.Style.Coordinates(0,0),e.pageX||e.pageY)t.page.x=!e.pageX||e.pageX<0?0:e.pageX,t.page.y=!e.pageY||e.pageY<0?0:e.pageY;else{var i=MochiKit.DOM._document.documentElement,n=MochiKit.DOM._document.body;t.page.x=e.clientX+(i.scrollLeft||n.scrollLeft)-(i.clientLeft||0),t.page.y=e.clientY+(i.scrollTop||n.scrollTop)-(i.clientTop||0)}return"mousemove"!=this.type()&&"mousewheel"!=this.type()&&(t.button={},t.button.left=!1,t.button.right=!1,t.button.middle=!1,e.which?(t.button.left=1==e.which,t.button.middle=2==e.which,t.button.right=3==e.which):(t.button.left=!!(1&e.button),t.button.right=!!(2&e.button),t.button.middle=!!(4&e.button))),"mousewheel"==this.type()&&(t.wheel=new MochiKit.Style.Coordinates(0,0),e.wheelDeltaX||e.wheelDeltaY?(t.wheel.x=e.wheelDeltaX/-40||0,t.wheel.y=e.wheelDeltaY/-40||0):e.wheelDelta?t.wheel.y=e.wheelDelta/-40:t.wheel.y=e.detail||0),this._mouse=t}},stop:function(){this.stopPropagation(),this.preventDefault()},stopPropagation:function(){this._event.stopPropagation?this._event.stopPropagation():this._event.cancelBubble=!0},preventDefault:function(){this._event.preventDefault?this._event.preventDefault():null===this._confirmUnload&&(this._event.returnValue=!1)},_confirmUnload:null,confirmUnload:function(t){"beforeunload"==this.type()&&(this._confirmUnload=t,this._event.returnValue=t)}}),MochiKit.Signal._specialMacKeys={3:"KEY_ENTER",63289:"KEY_NUM_PAD_CLEAR",63276:"KEY_PAGE_UP",63277:"KEY_PAGE_DOWN",63275:"KEY_END",63273:"KEY_HOME",63234:"KEY_ARROW_LEFT",63232:"KEY_ARROW_UP",63235:"KEY_ARROW_RIGHT",63233:"KEY_ARROW_DOWN",63302:"KEY_INSERT",63272:"KEY_DELETE"},function(){var t=MochiKit.Signal._specialMacKeys;for(i=63236;i<=63242;i++)t[i]="KEY_F"+(i-63236+1)}(),MochiKit.Signal._specialKeys={8:"KEY_BACKSPACE",9:"KEY_TAB",12:"KEY_NUM_PAD_CLEAR",13:"KEY_ENTER",16:"KEY_SHIFT",17:"KEY_CTRL",18:"KEY_ALT",19:"KEY_PAUSE",20:"KEY_CAPS_LOCK",27:"KEY_ESCAPE",32:"KEY_SPACEBAR",33:"KEY_PAGE_UP",34:"KEY_PAGE_DOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_ARROW_LEFT",38:"KEY_ARROW_UP",39:"KEY_ARROW_RIGHT",40:"KEY_ARROW_DOWN",44:"KEY_PRINT_SCREEN",45:"KEY_INSERT",46:"KEY_DELETE",59:"KEY_SEMICOLON",91:"KEY_WINDOWS_LEFT",92:"KEY_WINDOWS_RIGHT",93:"KEY_SELECT",106:"KEY_NUM_PAD_ASTERISK",107:"KEY_NUM_PAD_PLUS_SIGN",109:"KEY_NUM_PAD_HYPHEN-MINUS",110:"KEY_NUM_PAD_FULL_STOP",111:"KEY_NUM_PAD_SOLIDUS",144:"KEY_NUM_LOCK",145:"KEY_SCROLL_LOCK",186:"KEY_SEMICOLON",187:"KEY_EQUALS_SIGN",188:"KEY_COMMA",189:"KEY_HYPHEN-MINUS",190:"KEY_FULL_STOP",191:"KEY_SOLIDUS",192:"KEY_GRAVE_ACCENT",219:"KEY_LEFT_SQUARE_BRACKET",220:"KEY_REVERSE_SOLIDUS",221:"KEY_RIGHT_SQUARE_BRACKET",222:"KEY_APOSTROPHE"},function(){for(var t=MochiKit.Signal._specialKeys,e=48;e<=57;e++)t[e]="KEY_"+(e-48);for(e=65;e<=90;e++)t[e]="KEY_"+String.fromCharCode(e);for(e=96;e<=105;e++)t[e]="KEY_NUM_PAD_"+(e-96);for(e=112;e<=123;e++)t[e]="KEY_F"+(e-112+1)}(),MochiKit.Signal.Ident=function(t){this.source=t.source,this.signal=t.signal,this.listener=t.listener,this.isDOM=t.isDOM,this.objOrFunc=t.objOrFunc,this.funcOrStr=t.funcOrStr,this.connected=t.connected},MochiKit.Signal.Ident.prototype={},MochiKit.Base.update(MochiKit.Signal,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},_unloadCache:function(){for(var t=MochiKit.Signal,e=t._observers,i=0;i<e.length;i++)"onload"!==e[i].signal&&"onunload"!==e[i].signal&&t._disconnect(e[i])},_listener:function(i,n,o,r,t){var s=MochiKit.Signal.Event;return t?(r=r||i,"string"==typeof o?"onload"===n||"onunload"===n?function(t){r[o].apply(r,[new s(i,t)]);var e=new MochiKit.Signal.Ident({source:i,signal:n,objOrFunc:r,funcOrStr:o});MochiKit.Signal._disconnect(e)}:function(t){r[o].apply(r,[new s(i,t)])}:"onload"===n||"onunload"===n?function(t){o.apply(r,[new s(i,t)]);var e=new MochiKit.Signal.Ident({source:i,signal:n,objOrFunc:o});MochiKit.Signal._disconnect(e)}:function(t){o.apply(r,[new s(i,t)])}):void 0===o.im_self?MochiKit.Base.bindLate(o,r):o},_browserAlreadyHasMouseEnterAndLeave:function(){return/MSIE/.test(navigator.userAgent)},_browserLacksMouseWheelEvent:function(){return/Gecko\//.test(navigator.userAgent)},_mouseEnterListener:function(i,n,o,r){var s=MochiKit.Signal.Event;return function(t){var e=new s(i,t);try{e.relatedTarget().nodeName}catch(t){return}if(e.stop(),!MochiKit.DOM.isChildNode(e.relatedTarget(),i))return e.type=function(){return n},"string"==typeof o?r[o].apply(r,[e]):o.apply(r,[e])}},_getDestPair:function(t,e){var i=null,n=null;if(void 0!==e){if(i=t,"string"==typeof(n=e)){if("function"!=typeof t[e])throw new Error("'funcOrStr' must be a function on 'objOrFunc'")}else if("function"!=typeof e)throw new Error("'funcOrStr' must be a function or string")}else{if("function"!=typeof t)throw new Error("'objOrFunc' must be a function if 'funcOrStr' is not given");n=t}return[i,n]},connect:function(t,e,i,n){t=MochiKit.DOM.getElement(t);var o=MochiKit.Signal;if("string"!=typeof e)throw new Error("'sig' must be a string");var r=o._getDestPair(i,n),s=r[0],a=r[1];null==s&&(s=t);var l=!(!t.addEventListener&&!t.attachEvent);if(!l||"onmouseenter"!==e&&"onmouseleave"!==e||o._browserAlreadyHasMouseEnterAndLeave())if(l&&"onmousewheel"==e&&o._browserLacksMouseWheelEvent()){c=o._listener(t,e,a,s,l);e="onDOMMouseScroll"}else c=o._listener(t,e,a,s,l);else{var c=o._mouseEnterListener(t,e.substr(2),a,s);e="onmouseenter"===e?"onmouseover":"onmouseout"}t.addEventListener?t.addEventListener(e.substr(2),c,!1):t.attachEvent&&t.attachEvent(e,c);var h=new MochiKit.Signal.Ident({source:t,signal:e,listener:c,isDOM:l,objOrFunc:i,funcOrStr:n,connected:!0});if(o._observers.push(h),!l&&"function"==typeof t.__connect__){var u=MochiKit.Base.extend([h],arguments,1);t.__connect__.apply(t,u)}return h},_disconnect:function(t){if(t.connected){t.connected=!1;var e=t.source,i=t.signal,n=t.listener;if(t.isDOM)if(e.removeEventListener)e.removeEventListener(i.substr(2),n,!1);else{if(!e.detachEvent)throw new Error("'src' must be a DOM element");e.detachEvent(i,n)}else"function"==typeof e.__disconnect__&&e.__disconnect__(t,i,t.objOrFunc,t.funcOrStr)}},disconnect:function(t){var e=MochiKit.Signal,i=e._observers,n=MochiKit.Base;if(1<arguments.length)for(var o=MochiKit.DOM.getElement(t),r=arguments[1],s=arguments[2],a=arguments[3],l=i.length-1;0<=l;l--){var c=i[l];if(c.source===o&&c.signal===r&&c.objOrFunc===s&&c.funcOrStr===a)return e._disconnect(c),e._lock?e._dirty=!0:i.splice(l,1),!0}else{var h=n.findIdentical(i,t);if(0<=h)return e._disconnect(t),e._lock?e._dirty=!0:i.splice(h,1),!0}return!1},disconnectAllTo:function(t,e){var i=MochiKit.Signal,n=i._observers,o=i._disconnect,r=i._lock,s=i._dirty;void 0===e&&(e=null);for(var a=n.length-1;0<=a;a--){var l=n[a];l.objOrFunc!==t||null!==e&&l.funcOrStr!==e||(o(l),r?s=!0:n.splice(a,1))}i._dirty=s},disconnectAll:function(t,e){t=MochiKit.DOM.getElement(t);var i,n,o=MochiKit.Base,r=o.flattenArguments(o.extend(null,arguments,1)),s=MochiKit.Signal,a=s._disconnect,l=s._observers,c=s._lock,h=s._dirty;if(0===r.length)for(i=l.length-1;0<=i;i--)(n=l[i]).source===t&&(a(n),c?h=!0:l.splice(i,1));else{var u={};for(i=0;i<r.length;i++)u[r[i]]=!0;for(i=l.length-1;0<=i;i--)(n=l[i]).source===t&&n.signal in u&&(a(n),c?h=!0:l.splice(i,1))}s._dirty=h},signal:function(t,e){var i=MochiKit.Signal,n=i._observers;t=MochiKit.DOM.getElement(t);var o=MochiKit.Base.extend(null,arguments,2),r=[];i._lock=!0;for(var s=0;s<n.length;s++){var a=n[s];if(a.source===t&&a.signal===e&&a.connected)try{a.listener.apply(t,o)}catch(l){r.push(l)}}if(i._lock=!1,i._dirty){i._dirty=!1;for(s=n.length-1;0<=s;s--)n[s].connected||n.splice(s,1)}if(1==r.length)throw r[0];if(1<r.length){var l=new Error("Multiple errors thrown in handling 'sig', see errors property");throw l.errors=r,l}}}),MochiKit.Signal.EXPORT_OK=[],MochiKit.Signal.EXPORT=["connect","disconnect","signal","disconnectAll","disconnectAllTo"],MochiKit.Signal.__new__=function(t){var e=MochiKit.Base;this._document=document,this._window=t,this._lock=!1,this._dirty=!1;try{this.connect(window,"onunload",this._unloadCache)}catch(t){}this.EXPORT_TAGS={":common":this.EXPORT,":all":e.concat(this.EXPORT,this.EXPORT_OK)},e.nameFunctions(this)},MochiKit.Signal.__new__(this),MochiKit.__export__&&(connect=MochiKit.Signal.connect,disconnect=MochiKit.Signal.disconnect,disconnectAll=MochiKit.Signal.disconnectAll,signal=MochiKit.Signal.signal),MochiKit.Base._exportSymbols(this,MochiKit.Signal),MochiKit.Base._deps("Position",["Base","DOM","Style"]),MochiKit.Position.NAME="MochiKit.Position",MochiKit.Position.VERSION="1.4.2",MochiKit.Position.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Position.toString=function(){return this.__repr__()},MochiKit.Position.EXPORT_OK=[],MochiKit.Position.EXPORT=[],MochiKit.Base.update(MochiKit.Position,{includeScrollOffsets:!1,prepare:function(){var t=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;this.windowOffset=new MochiKit.Style.Coordinates(t,e)},cumulativeOffset:function(t){for(var e=0,i=0;e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent;);return new MochiKit.Style.Coordinates(i,e)},realOffset:function(t){for(var e=0,i=0;e+=t.scrollTop||0,i+=t.scrollLeft||0,t=t.parentNode;);return new MochiKit.Style.Coordinates(i,e)},within:function(t,e,i){return this.includeScrollOffsets?this.withinIncludingScrolloffsets(t,e,i):(this.xcomp=e,this.ycomp=i,this.offset=this.cumulativeOffset(t),"fixed"==t.style.position&&(this.offset.x+=this.windowOffset.x,this.offset.y+=this.windowOffset.y),i>=this.offset.y&&i<this.offset.y+t.offsetHeight&&e>=this.offset.x&&e<this.offset.x+t.offsetWidth)},withinIncludingScrolloffsets:function(t,e,i){var n=this.realOffset(t);return this.xcomp=e+n.x-this.windowOffset.x,this.ycomp=i+n.y-this.windowOffset.y,this.offset=this.cumulativeOffset(t),this.ycomp>=this.offset.y&&this.ycomp<this.offset.y+t.offsetHeight&&this.xcomp>=this.offset.x&&this.xcomp<this.offset.x+t.offsetWidth},overlap:function(t,e){return t?"vertical"==t?(this.offset.y+e.offsetHeight-this.ycomp)/e.offsetHeight:"horizontal"==t?(this.offset.x+e.offsetWidth-this.xcomp)/e.offsetWidth:void 0:0},absolutize:function(t){if("absolute"!=(t=MochiKit.DOM.getElement(t)).style.position){MochiKit.Position.prepare();var e=MochiKit.Position.positionedOffset(t),i=t.clientWidth,n=t.clientHeight,o={position:t.style.position,left:e.x-parseFloat(t.style.left||0),top:e.y-parseFloat(t.style.top||0),width:t.style.width,height:t.style.height};return t.style.position="absolute",t.style.top=e.y+"px",t.style.left=e.x+"px",t.style.width=i+"px",t.style.height=n+"px",o}},positionedOffset:function(t){var e=0,i=0;do{if(e+=t.offsetTop||0,i+=t.offsetLeft||0,(t=t.offsetParent)&&(p=MochiKit.Style.getStyle(t,"position"),"relative"==p||"absolute"==p))break}while(t);return new MochiKit.Style.Coordinates(i,e)},relativize:function(t,e){if("relative"!=(t=MochiKit.DOM.getElement(t)).style.position){MochiKit.Position.prepare();var i=parseFloat(t.style.top||0)-(e.top||0),n=parseFloat(t.style.left||0)-(e.left||0);t.style.position=e.position,t.style.top=i+"px",t.style.left=n+"px",t.style.width=e.width,t.style.height=e.height}},clone:function(t,e){t=MochiKit.DOM.getElement(t),(e=MochiKit.DOM.getElement(e)).style.position="absolute";var i=this.cumulativeOffset(t);e.style.top=i.y+"px",e.style.left=i.x+"px",e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px"},page:function(t){var e=0,i=0,n=t;do{if(e+=n.offsetTop||0,i+=n.offsetLeft||0,n.offsetParent==document.body&&"absolute"==MochiKit.Style.getStyle(n,"position"))break}while(n=n.offsetParent);for(n=t;e-=n.scrollTop||0,i-=n.scrollLeft||0,n=n.parentNode;);return new MochiKit.Style.Coordinates(i,e)}}),MochiKit.Position.__new__=function(t){var e=MochiKit.Base;this.EXPORT_TAGS={":common":this.EXPORT,":all":e.concat(this.EXPORT,this.EXPORT_OK)},e.nameFunctions(this)},MochiKit.Position.__new__(this),MochiKit.Base._exportSymbols(this,MochiKit.Position),MochiKit.Base._deps("Visual",["Base","DOM","Style","Color","Position"]),MochiKit.Visual.NAME="MochiKit.Visual",MochiKit.Visual.VERSION="1.4.2",MochiKit.Visual.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Visual.toString=function(){return this.__repr__()},MochiKit.Visual._RoundCorners=function(t,e){t=MochiKit.DOM.getElement(t),this._setOptions(e),this.options.__unstable__wrapElement&&(t=this._doWrap(t));var i=this.options.color,n=MochiKit.Color.Color;"fromElement"===this.options.color?i=n.fromBackground(t):i instanceof n||(i=n.fromString(i)),this.isTransparent=i.asRGB().a<=0;var o=this.options.bgColor;"fromParent"===this.options.bgColor?o=n.fromBackground(t.offsetParent):o instanceof n||(o=n.fromString(o)),this._roundCornersImpl(t,i,o)},MochiKit.Visual._RoundCorners.prototype={_doWrap:function(t){t.parentNode;var e=MochiKit.DOM.currentDocument();if(void 0===e.defaultView||null===e.defaultView)return t;var i=e.defaultView.getComputedStyle(t,null);if(null==i)return t;var n=MochiKit.DOM.DIV({style:{display:"block",marginTop:i.getPropertyValue("padding-top"),marginRight:i.getPropertyValue("padding-right"),marginBottom:i.getPropertyValue("padding-bottom"),marginLeft:i.getPropertyValue("padding-left"),padding:"0px"}});return n.innerHTML=t.innerHTML,t.innerHTML="",t.appendChild(n),t},_roundCornersImpl:function(t,e,i){this.options.border&&this._renderBorder(t,i),this._isTopRounded()&&this._roundTopCorners(t,e,i),this._isBottomRounded()&&this._roundBottomCorners(t,e,i)},_renderBorder:function(t,e){var i="1px solid "+this._borderColor(e),n="style='"+("border-left: "+i)+";"+("border-right: "+i)+"'";t.innerHTML="<div "+n+">"+t.innerHTML+"</div>"},_roundTopCorners:function(t,e,i){for(var n=this._createCorner(i),o=0;o<this.options.numSlices;o++)n.appendChild(this._createCornerSlice(e,i,o,"top"));t.style.paddingTop=0,t.insertBefore(n,t.firstChild)},_roundBottomCorners:function(t,e,i){for(var n=this._createCorner(i),o=this.options.numSlices-1;0<=o;o--)n.appendChild(this._createCornerSlice(e,i,o,"bottom"));t.style.paddingBottom=0,t.appendChild(n)},_createCorner:function(t){return MochiKit.DOM.DIV({style:{backgroundColor:t.toString()}})},_createCornerSlice:function(t,e,i,n){var o=MochiKit.DOM.SPAN(),r=o.style;r.backgroundColor=t.toString(),r.display="block",r.height="1px",r.overflow="hidden",r.fontSize="1px";var s=this._borderColor(t,e);return this.options.border&&0===i?(r.borderTopStyle="solid",r.borderTopWidth="1px",r.borderLeftWidth="0px",r.borderRightWidth="0px",r.borderBottomWidth="0px",r.height="0px",r.borderColor=s.toString()):s&&(r.borderColor=s.toString(),r.borderStyle="solid",r.borderWidth="0px 1px"),this.options.compact||i!=this.options.numSlices-1||(r.height="2px"),this._setMargin(o,i,n),this._setBorder(o,i,n),o},_setOptions:function(t){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1,__unstable__wrapElement:!1},MochiKit.Base.update(this.options,t),this.options.numSlices=this.options.compact?2:4},_whichSideTop:function(){var t=this.options.corners;if(this._hasString(t,"all","top"))return"";var e=-1!=t.indexOf("tl"),i=-1!=t.indexOf("tr");return e&&i?"":e?"left":i?"right":""},_whichSideBottom:function(){var t=this.options.corners;if(this._hasString(t,"all","bottom"))return"";var e=-1!=t.indexOf("bl"),i=-1!=t.indexOf("br");return e&&i?"":e?"left":i?"right":""},_borderColor:function(t,e){return"transparent"==t?e:this.options.border?this.options.border:this.options.blend?e.blendedColor(t):""},_setMargin:function(t,e,i){var n=this._marginSize(e)+"px",o="top"==i?this._whichSideTop():this._whichSideBottom(),r=t.style;"left"==o?(r.marginLeft=n,r.marginRight="0px"):"right"==o?(r.marginRight=n,r.marginLeft="0px"):(r.marginLeft=n,r.marginRight=n)},_setBorder:function(t,e,i){var n=this._borderSize(e)+"px",o="top"==i?this._whichSideTop():this._whichSideBottom(),r=t.style;"left"==o?(r.borderLeftWidth=n,r.borderRightWidth="0px"):"right"==o?(r.borderRightWidth=n,r.borderLeftWidth="0px"):(r.borderLeftWidth=n,r.borderRightWidth=n)},_marginSize:function(t){if(this.isTransparent)return 0;var e=this.options;if(e.compact&&e.blend){return[1,0][t]}if(e.compact){return[2,1][t]}if(e.blend){return[3,2,1,0][t]}return[5,3,2,1][t]},_borderSize:function(t){var e,i=this.options;if(i.compact&&(i.blend||this.isTransparent))return 1;if(i.compact)e=[1,0];else if(i.blend)e=[2,1,1,1];else if(i.border)e=[0,2,0,0];else{if(!this.isTransparent)return 0;e=[5,3,2,1]}return e[t]},_hasString:function(t){for(var e=1;e<arguments.length;e++)if(-1!=t.indexOf(arguments[e]))return!0;return!1},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(t){return 1==t.childNodes.length&&3==t.childNodes[0].nodeType}},MochiKit.Visual.roundElement=function(t,e){new MochiKit.Visual._RoundCorners(t,e)},MochiKit.Visual.roundClass=function(t,e,i){for(var n=MochiKit.DOM.getElementsByTagAndClassName(t,e),o=0;o<n.length;o++)MochiKit.Visual.roundElement(n[o],i)},MochiKit.Visual.tagifyText=function(i,n){n=n||"position:relative",/MSIE/.test(navigator.userAgent)&&(n+=";zoom:1"),i=MochiKit.DOM.getElement(i);var t=MochiKit.Base.map;t(function(e){3==e.nodeType&&(t(function(t){i.insertBefore(MochiKit.DOM.SPAN({style:n}," "==t?String.fromCharCode(160):t),e)},e.nodeValue.split("")),MochiKit.DOM.removeElement(e))},i.childNodes)},MochiKit.Visual.forceRerendering=function(t){try{t=MochiKit.DOM.getElement(t);var e=document.createTextNode(" ");t.appendChild(e),t.removeChild(e)}catch(t){}},MochiKit.Visual.multiple=function(t,e,i){var n=(i=MochiKit.Base.update({speed:.1,delay:0},i)).delay,o=0;MochiKit.Base.map(function(t){i.delay=o*i.speed+n,new e(t,i),o+=1},t)},MochiKit.Visual.PAIRS={slide:["slideDown","slideUp"],blind:["blindDown","blindUp"],appear:["appear","fade"],size:["grow","shrink"]},MochiKit.Visual.toggle=function(t,e,i){t=MochiKit.DOM.getElement(t),e=(e||"appear").toLowerCase(),i=MochiKit.Base.update({queue:{position:"end",scope:t.id||"global",limit:1}},i);var n=MochiKit.Visual;n["none"!=MochiKit.Style.getStyle(t,"display")?n.PAIRS[e][1]:n.PAIRS[e][0]](t,i)},MochiKit.Visual.Transitions={},MochiKit.Visual.Transitions.linear=function(t){return t},MochiKit.Visual.Transitions.sinoidal=function(t){return.5-Math.cos(t*Math.PI)/2},MochiKit.Visual.Transitions.reverse=function(t){return 1-t},MochiKit.Visual.Transitions.flicker=function(t){return.25-Math.cos(t*Math.PI)/4+Math.random()/2},MochiKit.Visual.Transitions.wobble=function(t){return.5-Math.cos(9*t*Math.PI)/2},MochiKit.Visual.Transitions.pulse=function(t,e){var i=(t*=e?2*e:10)-Math.floor(t);return Math.floor(t)%2==0?i:1-i},MochiKit.Visual.Transitions.parabolic=function(t){return t*t},MochiKit.Visual.Transitions.none=function(t){return 0},MochiKit.Visual.Transitions.full=function(t){return 1},MochiKit.Visual.ScopedQueue=function(){var t=arguments.callee;if(!(this instanceof t))return new t;this.__init__()},MochiKit.Base.update(MochiKit.Visual.ScopedQueue.prototype,{__init__:function(){this.effects=[],this.interval=null},add:function(e){var t=(new Date).getTime(),i="string"==typeof e.options.queue?e.options.queue:e.options.queue.position,n=MochiKit.Base.map;switch(i){case"front":n(function(t){"idle"==t.state&&(t.startOn+=e.finishOn,t.finishOn+=e.finishOn)},this.effects);break;case"end":var o;n(function(t){var e=t.finishOn;(o||e)<=e&&(o=e)},this.effects),t=o||t;break;case"break":n(function(t){t.finalize()},this.effects)}e.startOn+=t,e.finishOn+=t,(!e.options.queue.limit||this.effects.length<e.options.queue.limit)&&this.effects.push(e),this.interval||(this.interval=this.startLoop(MochiKit.Base.bind(this.loop,this),40))},startLoop:function(t,e){return setInterval(t,e)},remove:function(e){this.effects=MochiKit.Base.filter(function(t){return t!=e},this.effects),this.effects.length||(this.stopLoop(this.interval),this.interval=null)},stopLoop:function(t){clearInterval(t)},loop:function(){var e=(new Date).getTime();MochiKit.Base.map(function(t){t.loop(e)},this.effects)}}),MochiKit.Visual.Queues={instances:{},get:function(t){return"string"!=typeof t?t:(this.instances[t]||(this.instances[t]=new MochiKit.Visual.ScopedQueue),this.instances[t])}},MochiKit.Visual.Queue=MochiKit.Visual.Queues.get("global"),MochiKit.Visual.DefaultOptions={transition:MochiKit.Visual.Transitions.sinoidal,duration:1,fps:25,sync:!1,from:0,to:1,delay:0,queue:"parallel"},MochiKit.Visual.Base=function(){},MochiKit.Visual.Base.prototype={__class__:MochiKit.Visual.Base,start:function(t){var e=MochiKit.Visual;this.options=MochiKit.Base.setdefault(t,e.DefaultOptions),this.currentFrame=0,this.state="idle",this.startOn=1e3*this.options.delay,this.finishOn=this.startOn+1e3*this.options.duration,this.event("beforeStart"),this.options.sync||e.Queues.get("string"==typeof this.options.queue?"global":this.options.queue.scope).add(this)},loop:function(t){if(t>=this.startOn){if(t>=this.finishOn)return this.finalize();var e=(t-this.startOn)/(this.finishOn-this.startOn),i=Math.round(e*this.options.fps*this.options.duration);i>this.currentFrame&&(this.render(e),this.currentFrame=i)}},render:function(t){"idle"==this.state&&(this.state="running",this.event("beforeSetup"),this.setup(),this.event("afterSetup")),"running"==this.state&&(this.options.transition&&(t=this.options.transition(t)),t*=this.options.to-this.options.from,t+=this.options.from,this.event("beforeUpdate"),this.update(t),this.event("afterUpdate"))},cancel:function(){this.options.sync||MochiKit.Visual.Queues.get("string"==typeof this.options.queue?"global":this.options.queue.scope).remove(this),this.state="finished"},finalize:function(){this.render(1),this.cancel(),this.event("beforeFinish"),this.finish(),this.event("afterFinish")},setup:function(){},finish:function(){},update:function(t){},event:function(t){this.options[t+"Internal"]&&this.options[t+"Internal"](this),this.options[t]&&this.options[t](this)},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}},MochiKit.Visual.Parallel=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.Parallel.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Parallel.prototype,{__class__:MochiKit.Visual.Parallel,__init__:function(t,e){this.effects=t||[],this.start(e)},update:function(e){MochiKit.Base.map(function(t){t.render(e)},this.effects)},finish:function(){MochiKit.Base.map(function(t){t.finalize()},this.effects)}}),MochiKit.Visual.Sequence=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.Sequence.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Sequence.prototype,{__class__:MochiKit.Visual.Sequence,__init__:function(t,e){var i={transition:MochiKit.Visual.Transitions.linear,duration:0};this.effects=t||[],MochiKit.Base.map(function(t){i.duration+=t.options.duration},this.effects),MochiKit.Base.setdefault(e,i),this.start(e)},update:function(t){for(var e=t*this.options.duration,i=0;i<this.effects.length;i++){var n=this.effects[i];if(e<=n.options.duration){n.render(e/n.options.duration);break}e-=n.options.duration}},finish:function(){MochiKit.Base.map(function(t){t.finalize()},this.effects)}}),MochiKit.Visual.Opacity=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.Opacity.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Opacity.prototype,{__class__:MochiKit.Visual.Opacity,__init__:function(t,e){var i=MochiKit.Base,n=MochiKit.Style;this.element=MochiKit.DOM.getElement(t),this.element.currentStyle&&!this.element.currentStyle.hasLayout&&n.setStyle(this.element,{zoom:1}),e=i.update({from:n.getStyle(this.element,"opacity")||0,to:1},e),this.start(e)},update:function(t){MochiKit.Style.setStyle(this.element,{opacity:t})}}),MochiKit.Visual.Move=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.Move.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Move.prototype,{__class__:MochiKit.Visual.Move,__init__:function(t,e){this.element=MochiKit.DOM.getElement(t),e=MochiKit.Base.update({x:0,y:0,mode:"relative"},e),this.start(e)},setup:function(){MochiKit.Style.makePositioned(this.element);var t=this.element.style,e=t.visibility,i=t.display;"none"==i&&(t.visibility="hidden",t.display=""),this.originalLeft=parseFloat(MochiKit.Style.getStyle(this.element,"left")||"0"),this.originalTop=parseFloat(MochiKit.Style.getStyle(this.element,"top")||"0"),"absolute"==this.options.mode&&(this.options.x-=this.originalLeft,this.options.y-=this.originalTop),"none"==i&&(t.visibility=e,t.display=i)},update:function(t){MochiKit.Style.setStyle(this.element,{left:Math.round(this.options.x*t+this.originalLeft)+"px",top:Math.round(this.options.y*t+this.originalTop)+"px"})}}),MochiKit.Visual.Scale=function(t,e,i){var n=arguments.callee;if(!(this instanceof n))return new n(t,e,i);this.__init__(t,e,i)},MochiKit.Visual.Scale.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Scale.prototype,{__class__:MochiKit.Visual.Scale,__init__:function(t,e,i){this.element=MochiKit.DOM.getElement(t),i=MochiKit.Base.update({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:e},i),this.start(i)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1,this.elementPositioning=MochiKit.Style.getStyle(this.element,"position");var t=MochiKit.Base.map,e=MochiKit.Base.bind;this.originalStyle={},t(e(function(t){this.originalStyle[t]=this.element.style[t]},this),["top","left","width","height","fontSize"]),this.originalTop=this.element.offsetTop,this.originalLeft=this.element.offsetLeft;var i=MochiKit.Style.getStyle(this.element,"font-size")||"100%";t(e(function(t){0<i.indexOf(t)&&(this.fontSize=parseFloat(i),this.fontSizeType=t)},this),["em","px","%"]),this.factor=(this.options.scaleTo-this.options.scaleFrom)/100,/^content/.test(this.options.scaleMode)?this.dims=[this.element.scrollHeight,this.element.scrollWidth]:"box"==this.options.scaleMode?this.dims=[this.element.offsetHeight,this.element.offsetWidth]:this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]},update:function(t){var e=this.options.scaleFrom/100+this.factor*t;this.options.scaleContent&&this.fontSize&&MochiKit.Style.setStyle(this.element,{fontSize:this.fontSize*e+this.fontSizeType}),this.setDimensions(this.dims[0]*e,this.dims[1]*e)},finish:function(){this.restoreAfterFinish&&MochiKit.Style.setStyle(this.element,this.originalStyle)},setDimensions:function(t,e){var i={},n=Math.round;if(/MSIE/.test(navigator.userAgent)&&(n=Math.ceil),this.options.scaleX&&(i.width=n(e)+"px"),this.options.scaleY&&(i.height=n(t)+"px"),this.options.scaleFromCenter){var o=(t-this.dims[0])/2,r=(e-this.dims[1])/2;"absolute"==this.elementPositioning?(this.options.scaleY&&(i.top=this.originalTop-o+"px"),this.options.scaleX&&(i.left=this.originalLeft-r+"px")):(this.options.scaleY&&(i.top=-o+"px"),this.options.scaleX&&(i.left=-r+"px"))}MochiKit.Style.setStyle(this.element,i)}}),MochiKit.Visual.Highlight=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.Highlight.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Highlight.prototype,{__class__:MochiKit.Visual.Highlight,__init__:function(t,e){this.element=MochiKit.DOM.getElement(t),e=MochiKit.Base.update({startcolor:"#ffff99"},e),this.start(e)},setup:function(){var t=MochiKit.Base,e=MochiKit.Style;"none"!=e.getStyle(this.element,"display")?(this.oldStyle={backgroundImage:e.getStyle(this.element,"background-image")},e.setStyle(this.element,{backgroundImage:"none"}),this.options.endcolor||(this.options.endcolor=MochiKit.Color.Color.fromBackground(this.element).toHexString()),t.isUndefinedOrNull(this.options.restorecolor)&&(this.options.restorecolor=e.getStyle(this.element,"background-color")),this._base=t.map(t.bind(function(t){return parseInt(this.options.startcolor.slice(2*t+1,2*t+3),16)},this),[0,1,2]),this._delta=t.map(t.bind(function(t){return parseInt(this.options.endcolor.slice(2*t+1,2*t+3),16)-this._base[t]},this),[0,1,2])):this.cancel()},update:function(e){var i="#";MochiKit.Base.map(MochiKit.Base.bind(function(t){i+=MochiKit.Color.toColorPart(Math.round(this._base[t]+this._delta[t]*e))},this),[0,1,2]),MochiKit.Style.setStyle(this.element,{backgroundColor:i})},finish:function(){MochiKit.Style.setStyle(this.element,MochiKit.Base.update(this.oldStyle,{backgroundColor:this.options.restorecolor}))}}),MochiKit.Visual.ScrollTo=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.ScrollTo.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.ScrollTo.prototype,{__class__:MochiKit.Visual.ScrollTo,__init__:function(t,e){this.element=MochiKit.DOM.getElement(t),this.start(e)},setup:function(){var t=MochiKit.Position;t.prepare();var e,i=t.cumulativeOffset(this.element);this.options.offset&&(i.y+=this.options.offset),window.innerHeight?e=window.innerHeight-window.height:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight-document.body.scrollHeight:document.body&&(e=document.body.clientHeight-document.body.scrollHeight),this.scrollStart=t.windowOffset.y,this.delta=(i.y>e?e:i.y)-this.scrollStart},update:function(t){var e=MochiKit.Position;e.prepare(),window.scrollTo(e.windowOffset.x,this.scrollStart+t*this.delta)}}),MochiKit.Visual.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,MochiKit.Visual.Morph=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.Visual.Morph.prototype=new MochiKit.Visual.Base,MochiKit.Base.update(MochiKit.Visual.Morph.prototype,{__class__:MochiKit.Visual.Morph,__init__:function(t,e){this.element=MochiKit.DOM.getElement(t),this.start(e)},setup:function(){var t,e,i=MochiKit.Base,n=this.options.style;for(var o in this.styleStart={},this.styleEnd={},this.units={},n)if(t=n[o],o=i.camelize(o),MochiKit.Visual.CSS_LENGTH.test(t)){var r=t.match(/^([\+\-]?[0-9\.]+)(.*)$/);t=parseFloat(r[1]),e=3==r.length?r[2]:null,this.styleEnd[o]=t,this.units[o]=e,r=(t=MochiKit.Style.getStyle(this.element,o)).match(/^([\+\-]?[0-9\.]+)(.*)$/),t=parseFloat(r[1]),this.styleStart[o]=t}else if(/[Cc]olor$/.test(o)){var s=MochiKit.Color.Color;(t=s.fromString(t))&&(this.units[o]="color",this.styleEnd[o]=t.toHexString(),t=MochiKit.Style.getStyle(this.element,o),this.styleStart[o]=s.fromString(t).toHexString(),this.styleStart[o]=i.map(i.bind(function(t){return parseInt(this.styleStart[o].slice(2*t+1,2*t+3),16)},this),[0,1,2]),this.styleEnd[o]=i.map(i.bind(function(t){return parseInt(this.styleEnd[o].slice(2*t+1,2*t+3),16)},this),[0,1,2]))}else this.element.style[o]=t},update:function(e){var t;for(var i in this.styleStart)if("color"==this.units[i]){var n="#",o=this.styleStart[i],r=this.styleEnd[i];MochiKit.Base.map(MochiKit.Base.bind(function(t){n+=MochiKit.Color.toColorPart(Math.round(o[t]+(r[t]-o[t])*e))},this),[0,1,2]),this.element.style[i]=n}else t=this.styleStart[i]+Math.round((this.styleEnd[i]-this.styleStart[i])*e*1e3)/1e3+this.units[i],this.element.style[i]=t}}),MochiKit.Visual.fade=function(t,e){var i=MochiKit.Style,n=i.getStyle(t,"opacity");return e=MochiKit.Base.update({from:i.getStyle(t,"opacity")||1,to:0,afterFinishInternal:function(t){0===t.options.to&&(i.hideElement(t.element),i.setStyle(t.element,{opacity:n}))}},e),new MochiKit.Visual.Opacity(t,e)},MochiKit.Visual.appear=function(t,e){var i=MochiKit.Style,n=MochiKit.Visual;return e=MochiKit.Base.update({from:"none"==i.getStyle(t,"display")?0:i.getStyle(t,"opacity")||0,to:1,afterFinishInternal:function(t){n.forceRerendering(t.element)},beforeSetupInternal:function(t){i.setStyle(t.element,{opacity:t.options.from}),i.showElement(t.element)}},e),new n.Opacity(t,e)},MochiKit.Visual.puff=function(t,e){var i=MochiKit.Style,n=MochiKit.Visual;t=MochiKit.DOM.getElement(t);var o=MochiKit.Style.getElementDimensions(t,!0),r={position:i.getStyle(t,"position"),top:t.style.top,left:t.style.left,width:t.style.width,height:t.style.height,opacity:i.getStyle(t,"opacity")};return e=MochiKit.Base.update({beforeSetupInternal:function(t){MochiKit.Position.absolutize(t.effects[0].element)},afterFinishInternal:function(t){i.hideElement(t.effects[0].element),i.setStyle(t.effects[0].element,r)},scaleContent:!0,scaleFromCenter:!0},e),new n.Parallel([new n.Scale(t,200,{sync:!0,scaleFromCenter:e.scaleFromCenter,scaleMode:{originalHeight:o.h,originalWidth:o.w},scaleContent:e.scaleContent,restoreAfterFinish:!0}),new n.Opacity(t,{sync:!0,to:0})],e)},MochiKit.Visual.blindUp=function(t,e){var i=MochiKit.DOM,n=MochiKit.Style;t=i.getElement(t);var o=n.getElementDimensions(t,!0),r=n.makeClipping(t);return e=MochiKit.Base.update({scaleContent:!1,scaleX:!1,scaleMode:{originalHeight:o.h,originalWidth:o.w},restoreAfterFinish:!0,afterFinishInternal:function(t){n.hideElement(t.element),n.undoClipping(t.element,r)}},e),new MochiKit.Visual.Scale(t,0,e)},MochiKit.Visual.blindDown=function(t,e){var i=MochiKit.DOM,n=MochiKit.Style;t=i.getElement(t);var o,r=n.getElementDimensions(t,!0);return e=MochiKit.Base.update({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:r.h,originalWidth:r.w},restoreAfterFinish:!0,afterSetupInternal:function(t){o=n.makeClipping(t.element),n.setStyle(t.element,{height:"0px"}),n.showElement(t.element)},afterFinishInternal:function(t){n.undoClipping(t.element,o)}},e),new MochiKit.Visual.Scale(t,100,e)},MochiKit.Visual.switchOff=function(e,t){var i=MochiKit.DOM,n=MochiKit.Style;e=i.getElement(e);var o,r=n.getElementDimensions(e,!0),s=n.getStyle(e,"opacity");t=MochiKit.Base.update({duration:.7,restoreAfterFinish:!0,beforeSetupInternal:function(t){n.makePositioned(e),o=n.makeClipping(e)},afterFinishInternal:function(t){n.hideElement(e),n.undoClipping(e,o),n.undoPositioned(e),n.setStyle(e,{opacity:s})}},t);var a=MochiKit.Visual;return new a.Sequence([new a.appear(e,{sync:!0,duration:.57*t.duration,from:0,transition:a.Transitions.flicker}),new a.Scale(e,1,{sync:!0,duration:.43*t.duration,scaleFromCenter:!0,scaleX:!1,scaleMode:{originalHeight:r.h,originalWidth:r.w},scaleContent:!1,restoreAfterFinish:!0})],t)},MochiKit.Visual.dropOut=function(t,e){var i=MochiKit.DOM,n=MochiKit.Style;t=i.getElement(t);var o={top:n.getStyle(t,"top"),left:n.getStyle(t,"left"),opacity:n.getStyle(t,"opacity")};e=MochiKit.Base.update({duration:.5,distance:100,beforeSetupInternal:function(t){n.makePositioned(t.effects[0].element)},afterFinishInternal:function(t){n.hideElement(t.effects[0].element),n.undoPositioned(t.effects[0].element),n.setStyle(t.effects[0].element,o)}},e);var r=MochiKit.Visual;return new r.Parallel([new r.Move(t,{x:0,y:e.distance,sync:!0}),new r.Opacity(t,{sync:!0,to:0})],e)},MochiKit.Visual.shake=function(e,t){var i=MochiKit.DOM,n=MochiKit.Visual,o=MochiKit.Style;e=i.getElement(e);var r={top:o.getStyle(e,"top"),left:o.getStyle(e,"left")};return t=MochiKit.Base.update({duration:.5,afterFinishInternal:function(t){o.undoPositioned(e),o.setStyle(e,r)}},t),new n.Sequence([new n.Move(e,{sync:!0,duration:.1*t.duration,x:20,y:0}),new n.Move(e,{sync:!0,duration:.2*t.duration,x:-40,y:0}),new n.Move(e,{sync:!0,duration:.2*t.duration,x:40,y:0}),new n.Move(e,{sync:!0,duration:.2*t.duration,x:-40,y:0}),new n.Move(e,{sync:!0,duration:.2*t.duration,x:40,y:0}),new n.Move(e,{sync:!0,duration:.1*t.duration,x:-20,y:0})],t)},MochiKit.Visual.slideDown=function(t,e){var i=MochiKit.DOM,n=MochiKit.Base,o=MochiKit.Style;if(!(t=i.getElement(t)).firstChild)throw new Error("MochiKit.Visual.slideDown must be used on a element with a child");i.removeEmptyTextNodes(t);var r,s=o.getStyle(t.firstChild,"bottom")||0,a=o.getElementDimensions(t,!0);return e=n.update({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:a.h,originalWidth:a.w},restoreAfterFinish:!0,afterSetupInternal:function(t){o.makePositioned(t.element),o.makePositioned(t.element.firstChild),/Opera/.test(navigator.userAgent)&&o.setStyle(t.element,{top:""}),r=o.makeClipping(t.element),o.setStyle(t.element,{height:"0px"}),o.showElement(t.element)},afterUpdateInternal:function(t){var e=o.getElementDimensions(t.element,!0);o.setStyle(t.element.firstChild,{bottom:t.dims[0]-e.h+"px"})},afterFinishInternal:function(t){o.undoClipping(t.element,r),/MSIE/.test(navigator.userAgent)?(o.undoPositioned(t.element),o.undoPositioned(t.element.firstChild)):(o.undoPositioned(t.element.firstChild),o.undoPositioned(t.element)),o.setStyle(t.element.firstChild,{bottom:s})}},e),new MochiKit.Visual.Scale(t,100,e)},MochiKit.Visual.slideUp=function(t,e){var i=MochiKit.DOM,n=MochiKit.Base,o=MochiKit.Style;if(!(t=i.getElement(t)).firstChild)throw new Error("MochiKit.Visual.slideUp must be used on a element with a child");i.removeEmptyTextNodes(t);var r,s=o.getStyle(t.firstChild,"bottom"),a=o.getElementDimensions(t,!0);return e=n.update({scaleContent:!1,scaleX:!1,scaleMode:{originalHeight:a.h,originalWidth:a.w},scaleFrom:100,restoreAfterFinish:!0,beforeStartInternal:function(t){o.makePositioned(t.element),o.makePositioned(t.element.firstChild),/Opera/.test(navigator.userAgent)&&o.setStyle(t.element,{top:""}),r=o.makeClipping(t.element),o.showElement(t.element)},afterUpdateInternal:function(t){var e=o.getElementDimensions(t.element,!0);o.setStyle(t.element.firstChild,{bottom:t.dims[0]-e.h+"px"})},afterFinishInternal:function(t){o.hideElement(t.element),o.undoClipping(t.element,r),o.undoPositioned(t.element.firstChild),o.undoPositioned(t.element),o.setStyle(t.element.firstChild,{bottom:s})}},e),new MochiKit.Visual.Scale(t,0,e)},MochiKit.Visual.squish=function(t,e){MochiKit.DOM;var i,n=MochiKit.Base,o=MochiKit.Style,r=o.getElementDimensions(t,!0);return e=n.update({restoreAfterFinish:!0,scaleMode:{originalHeight:r.w,originalWidth:r.h},beforeSetupInternal:function(t){i=o.makeClipping(t.element)},afterFinishInternal:function(t){o.hideElement(t.element),o.undoClipping(t.element,i)}},e),new MochiKit.Visual.Scale(t,/Opera/.test(navigator.userAgent)?1:0,e)},MochiKit.Visual.grow=function(t,e){var i=MochiKit.DOM,n=MochiKit.Visual,o=MochiKit.Style;t=i.getElement(t),e=MochiKit.Base.update({direction:"center",moveTransition:n.Transitions.sinoidal,scaleTransition:n.Transitions.sinoidal,opacityTransition:n.Transitions.full,scaleContent:!0,scaleFromCenter:!1},e);var r,s,a,l,c={top:t.style.top,left:t.style.left,height:t.style.height,width:t.style.width,opacity:o.getStyle(t,"opacity")},h=o.getElementDimensions(t,!0);switch(e.direction){case"top-left":r=s=a=l=0;break;case"top-right":r=h.w,s=l=0,a=-h.w;break;case"bottom-left":r=a=0,s=h.h,l=-h.h;break;case"bottom-right":r=h.w,s=h.h,a=-h.w,l=-h.h;break;case"center":r=h.w/2,s=h.h/2,a=-h.w/2,l=-h.h/2}var u=MochiKit.Base.update({beforeSetupInternal:function(t){o.setStyle(t.effects[0].element,{height:"0px"}),o.showElement(t.effects[0].element)},afterFinishInternal:function(t){o.undoClipping(t.effects[0].element),o.undoPositioned(t.effects[0].element),o.setStyle(t.effects[0].element,c)}},e);return new n.Move(t,{x:r,y:s,duration:.01,beforeSetupInternal:function(t){o.hideElement(t.element),o.makeClipping(t.element),o.makePositioned(t.element)},afterFinishInternal:function(t){new n.Parallel([new n.Opacity(t.element,{sync:!0,to:1,from:0,transition:e.opacityTransition}),new n.Move(t.element,{x:a,y:l,sync:!0,transition:e.moveTransition}),new n.Scale(t.element,100,{scaleMode:{originalHeight:h.h,originalWidth:h.w},sync:!0,scaleFrom:/Opera/.test(navigator.userAgent)?1:0,transition:e.scaleTransition,scaleContent:e.scaleContent,scaleFromCenter:e.scaleFromCenter,restoreAfterFinish:!0})],u)}})},MochiKit.Visual.shrink=function(t,e){var i=MochiKit.DOM,n=MochiKit.Visual,o=MochiKit.Style;t=i.getElement(t),e=MochiKit.Base.update({direction:"center",moveTransition:n.Transitions.sinoidal,scaleTransition:n.Transitions.sinoidal,opacityTransition:n.Transitions.none,scaleContent:!0,scaleFromCenter:!1},e);var r,s,a,l={top:t.style.top,left:t.style.left,height:t.style.height,width:t.style.width,opacity:o.getStyle(t,"opacity")},c=o.getElementDimensions(t,!0);switch(e.direction){case"top-left":r=s=0;break;case"top-right":r=c.w,s=0;break;case"bottom-left":r=0,s=c.h;break;case"bottom-right":r=c.w,s=c.h;break;case"center":r=c.w/2,s=c.h/2}var h=MochiKit.Base.update({beforeStartInternal:function(t){o.makePositioned(t.effects[0].element),a=o.makeClipping(t.effects[0].element)},afterFinishInternal:function(t){o.hideElement(t.effects[0].element),o.undoClipping(t.effects[0].element,a),o.undoPositioned(t.effects[0].element),o.setStyle(t.effects[0].element,l)}},e);return new n.Parallel([new n.Opacity(t,{sync:!0,to:0,from:1,transition:e.opacityTransition}),new n.Scale(t,/Opera/.test(navigator.userAgent)?1:0,{scaleMode:{originalHeight:c.h,originalWidth:c.w},sync:!0,transition:e.scaleTransition,scaleContent:e.scaleContent,scaleFromCenter:e.scaleFromCenter,restoreAfterFinish:!0}),new n.Move(t,{x:r,y:s,sync:!0,transition:e.moveTransition})],h)},MochiKit.Visual.pulsate=function(t,e){MochiKit.DOM;var i=MochiKit.Visual,n=MochiKit.Base,o=MochiKit.Style.getStyle(t,"opacity"),r=(e=n.update({duration:3,from:0,afterFinishInternal:function(t){MochiKit.Style.setStyle(t.element,{opacity:o})}},e)).transition||i.Transitions.sinoidal;return e.transition=function(t){return r(1-i.Transitions.pulse(t,e.pulses))},new i.Opacity(t,e)},MochiKit.Visual.fold=function(e,t){var i=MochiKit.DOM,n=MochiKit.Visual,o=MochiKit.Style;e=i.getElement(e);var r=o.getElementDimensions(e,!0),s={top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height},a=o.makeClipping(e);return t=MochiKit.Base.update({scaleContent:!1,scaleX:!1,scaleMode:{originalHeight:r.h,originalWidth:r.w},afterFinishInternal:function(t){new n.Scale(e,1,{scaleContent:!1,scaleY:!1,scaleMode:{originalHeight:r.h,originalWidth:r.w},afterFinishInternal:function(t){o.hideElement(t.element),o.undoClipping(t.element,a),o.setStyle(t.element,s)}})}},t),new n.Scale(e,5,t)},MochiKit.Visual.Color=MochiKit.Color.Color,MochiKit.Visual.getElementsComputedStyle=MochiKit.DOM.computedStyle,MochiKit.Visual.__new__=function(){var t=MochiKit.Base;t.nameFunctions(this),this.EXPORT_TAGS={":common":this.EXPORT,":all":t.concat(this.EXPORT,this.EXPORT_OK)}},MochiKit.Visual.EXPORT=["roundElement","roundClass","tagifyText","multiple","toggle","Parallel","Sequence","Opacity","Move","Scale","Highlight","ScrollTo","Morph","fade","appear","puff","blindUp","blindDown","switchOff","dropOut","shake","slideDown","slideUp","squish","grow","shrink","pulsate","fold"],MochiKit.Visual.EXPORT_OK=["Base","PAIRS"],MochiKit.Visual.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Visual),MochiKit.Base._deps("DragAndDrop",["Base","Iter","DOM","Signal","Visual","Position"]),MochiKit.DragAndDrop.NAME="MochiKit.DragAndDrop",MochiKit.DragAndDrop.VERSION="1.4.2",MochiKit.DragAndDrop.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.DragAndDrop.toString=function(){return this.__repr__()},MochiKit.DragAndDrop.EXPORT=["Droppable","Draggable"],MochiKit.DragAndDrop.EXPORT_OK=["Droppables","Draggables"],MochiKit.DragAndDrop.Droppables={drops:[],remove:function(e){this.drops=MochiKit.Base.filter(function(t){return t.element!=MochiKit.DOM.getElement(e)},this.drops)},register:function(t){this.drops.push(t)},unregister:function(e){this.drops=MochiKit.Base.filter(function(t){return t!=e},this.drops)},prepare:function(e){MochiKit.Base.map(function(t){t.isAccepted(e)&&(t.options.activeclass&&MochiKit.DOM.addElementClass(t.element,t.options.activeclass),t.options.onactive(t.element,e))},this.drops)},findDeepestChild:function(t){for(deepest=t[0],i=1;i<t.length;++i)MochiKit.DOM.isChildNode(t[i].element,deepest.element)&&(deepest=t[i]);return deepest},show:function(e,i){if(this.drops.length){var n=[];this.last_active&&this.last_active.deactivate(),MochiKit.Iter.forEach(this.drops,function(t){t.isAffected(e,i)&&n.push(t)}),0<n.length&&(drop=this.findDeepestChild(n),MochiKit.Position.within(drop.element,e.page.x,e.page.y),drop.options.onhover(i,drop.element,MochiKit.Position.overlap(drop.options.overlap,drop.element)),drop.activate())}},fire:function(t,e){this.last_active&&(MochiKit.Position.prepare(),this.last_active.isAffected(t.mouse(),e)&&this.last_active.options.ondrop(e,this.last_active.element,t))},reset:function(e){MochiKit.Base.map(function(t){t.options.activeclass&&MochiKit.DOM.removeElementClass(t.element,t.options.activeclass),t.options.ondesactive(t.element,e)},this.drops),this.last_active&&this.last_active.deactivate()}},MochiKit.DragAndDrop.Droppable=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.DragAndDrop.Droppable.prototype={__class__:MochiKit.DragAndDrop.Droppable,__init__:function(t,e){var i=MochiKit.DOM,n=MochiKit.Base;this.element=i.getElement(t),this.options=n.update({greedy:!0,hoverclass:null,activeclass:null,hoverfunc:n.noop,accept:null,onactive:n.noop,ondesactive:n.noop,onhover:n.noop,ondrop:n.noop,containment:[],tree:!1},e),this.options._containers=[],n.map(MochiKit.Base.bind(function(t){this.options._containers.push(i.getElement(t))},this),this.options.containment),MochiKit.Style.makePositioned(this.element),MochiKit.DragAndDrop.Droppables.register(this)},isContained:function(t){var e;return!this.options._containers.length||(e=this.options.tree?t.treeNode:t.parentNode,MochiKit.Iter.some(this.options._containers,function(t){return e==t}))},isAccepted:function(e){return!this.options.accept||MochiKit.Iter.some(this.options.accept,function(t){return MochiKit.DOM.hasElementClass(e,t)})},isAffected:function(t,e){return this.element!=e&&this.isContained(e)&&this.isAccepted(e)&&MochiKit.Position.within(this.element,t.page.x,t.page.y)},deactivate:function(){this.options.hoverclass&&MochiKit.DOM.removeElementClass(this.element,this.options.hoverclass),this.options.hoverfunc(this.element,!1),MochiKit.DragAndDrop.Droppables.last_active=null},activate:function(){this.options.hoverclass&&MochiKit.DOM.addElementClass(this.element,this.options.hoverclass),this.options.hoverfunc(this.element,!0),MochiKit.DragAndDrop.Droppables.last_active=this},destroy:function(){MochiKit.DragAndDrop.Droppables.unregister(this)},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}},MochiKit.DragAndDrop.Draggables={drags:[],register:function(t){if(0===this.drags.length){var e=MochiKit.Signal.connect;this.eventMouseUp=e(document,"onmouseup",this,this.endDrag),this.eventMouseMove=e(document,"onmousemove",this,this.updateDrag),this.eventKeypress=e(document,"onkeypress",this,this.keyPress)}this.drags.push(t)},unregister:function(e){if(this.drags=MochiKit.Base.filter(function(t){return t!=e},this.drags),0===this.drags.length){var t=MochiKit.Signal.disconnect;t(this.eventMouseUp),t(this.eventMouseMove),t(this.eventKeypress)}},activate:function(t){window.focus(),this.activeDraggable=t},deactivate:function(){this.activeDraggable=null},updateDrag:function(t){if(this.activeDraggable){var e=t.mouse();this._lastPointer&&MochiKit.Base.repr(this._lastPointer.page)==MochiKit.Base.repr(e.page)||(this._lastPointer=e,this.activeDraggable.updateDrag(t,e))}},endDrag:function(t){this.activeDraggable&&(this._lastPointer=null,this.activeDraggable.endDrag(t),this.activeDraggable=null)},keyPress:function(t){this.activeDraggable&&this.activeDraggable.keyPress(t)},notify:function(t,e,i){MochiKit.Signal.signal(this,t,e,i)}},MochiKit.DragAndDrop.Draggable=function(t,e){var i=arguments.callee;if(!(this instanceof i))return new i(t,e);this.__init__(t,e)},MochiKit.DragAndDrop.Draggable.prototype={__class__:MochiKit.DragAndDrop.Draggable,__init__:function(t,e){var o=MochiKit.Visual,i=MochiKit.Base;e=i.update({handle:!1,starteffect:function(t){this._savedOpacity=MochiKit.Style.getStyle(t,"opacity")||1,new o.Opacity(t,{duration:.2,from:this._savedOpacity,to:.7})},reverteffect:function(t,e,i){var n=.02*Math.sqrt(Math.abs(2^e)+Math.abs(2^i));return new o.Move(t,{x:-i,y:-e,duration:n})},endeffect:function(t){new o.Opacity(t,{duration:.2,from:.7,to:this._savedOpacity})},onchange:i.noop,zindex:1e3,revert:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,snap:!1},e);var n=MochiKit.DOM;this.element=n.getElement(t),e.handle&&"string"==typeof e.handle&&(this.handle=n.getFirstElementByTagAndClassName(null,e.handle,this.element)),this.handle||(this.handle=n.getElement(e.handle)),this.handle||(this.handle=this.element),!e.scroll||e.scroll.scrollTo||e.scroll.outerHTML||(e.scroll=n.getElement(e.scroll),this._isScrollChild=MochiKit.DOM.isChildNode(this.element,e.scroll)),MochiKit.Style.makePositioned(this.element),this.delta=this.currentDelta(),this.options=e,this.dragging=!1,this.eventMouseDown=MochiKit.Signal.connect(this.handle,"onmousedown",this,this.initDrag),MochiKit.DragAndDrop.Draggables.register(this)},destroy:function(){MochiKit.Signal.disconnect(this.eventMouseDown),MochiKit.DragAndDrop.Draggables.unregister(this)},currentDelta:function(){var t=MochiKit.Style.getStyle;return[parseInt(t(this.element,"left")||"0"),parseInt(t(this.element,"top")||"0")]},initDrag:function(t){if(t.mouse().button.left){var e=(t.target().tagName||"").toUpperCase();if("INPUT"!==e&&"SELECT"!==e&&"OPTION"!==e&&"BUTTON"!==e&&"TEXTAREA"!==e){this._revert&&(this._revert.cancel(),this._revert=null);var i=t.mouse(),n=MochiKit.Position.cumulativeOffset(this.element);this.offset=[i.page.x-n.x,i.page.y-n.y],MochiKit.DragAndDrop.Draggables.activate(this),t.stop()}}},startDrag:function(t){if(this.dragging=!0,this.options.selectclass&&MochiKit.DOM.addElementClass(this.element,this.options.selectclass),this.options.zindex&&(this.originalZ=parseInt(MochiKit.Style.getStyle(this.element,"z-index")||"0"),this.element.style.zIndex=this.options.zindex),this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this.ghostPosition=MochiKit.Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element)),this.options.scroll)if(this.options.scroll==window){var e=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=e.left,this.originalScrollTop=e.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,this.originalScrollTop=this.options.scroll.scrollTop;MochiKit.DragAndDrop.Droppables.prepare(this.element),MochiKit.DragAndDrop.Draggables.notify("start",this,t),this.options.starteffect&&this.options.starteffect(this.element)},updateDrag:function(t,e){if(this.dragging||this.startDrag(t),MochiKit.Position.prepare(),MochiKit.DragAndDrop.Droppables.show(e,this.element),MochiKit.DragAndDrop.Draggables.notify("drag",this,t),this.draw(e),this.options.onchange(this),this.options.scroll){var i,n;if(this.stopScrolling(),this.options.scroll==window){var o=this._getWindowScroll(this.options.scroll);i=new MochiKit.Style.Coordinates(o.left,o.top),n=new MochiKit.Style.Coordinates(o.left+o.width,o.top+o.height)}else(i=MochiKit.Position.page(this.options.scroll)).x+=this.options.scroll.scrollLeft,i.y+=this.options.scroll.scrollTop,i.x+=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,i.y+=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=new MochiKit.Style.Coordinates(i.x+this.options.scroll.offsetWidth,i.y+this.options.scroll.offsetHeight);var r=[0,0];e.page.x>n.x-this.options.scrollSensitivity?r[0]=e.page.x-(n.x-this.options.scrollSensitivity):e.page.x<i.x+this.options.scrollSensitivity&&(r[0]=e.page.x-(i.x+this.options.scrollSensitivity)),e.page.y>n.y-this.options.scrollSensitivity?r[1]=e.page.y-(n.y-this.options.scrollSensitivity):e.page.y<i.y+this.options.scrollSensitivity&&(r[1]=e.page.y-(i.y+this.options.scrollSensitivity)),this.startScrolling(r)}/AppleWebKit/.test(navigator.appVersion)&&window.scrollBy(0,0),t.stop()},finishDrag:function(t,e){var i=MochiKit.DragAndDrop;this.dragging=!1,this.options.selectclass&&MochiKit.DOM.removeElementClass(this.element,this.options.selectclass),this.options.ghosting&&(MochiKit.Position.relativize(this.element,this.ghostPosition),MochiKit.DOM.removeElement(this._clone),this._clone=null),e&&i.Droppables.fire(t,this.element),i.Draggables.notify("end",this,t);var n=this.options.revert;n&&"function"==typeof n&&(n=n(this.element));var o=this.currentDelta();n&&this.options.reverteffect?this._revert=this.options.reverteffect(this.element,o[1]-this.delta[1],o[0]-this.delta[0]):this.delta=o,this.options.zindex&&(this.element.style.zIndex=this.originalZ),this.options.endeffect&&this.options.endeffect(this.element),i.Draggables.deactivate(),i.Droppables.reset(this.element)},keyPress:function(t){"KEY_ESCAPE"==t.key().string&&(this.finishDrag(t,!1),t.stop())},endDrag:function(t){this.dragging&&(this.stopScrolling(),this.finishDrag(t,!0),t.stop())},draw:function(t){var e=MochiKit.Position.cumulativeOffset(this.element),i=this.currentDelta();e.x-=i[0],e.y-=i[1],this.options.scroll&&this.options.scroll!=window&&this._isScrollChild&&(e.x-=this.options.scroll.scrollLeft-this.originalScrollLeft,e.y-=this.options.scroll.scrollTop-this.originalScrollTop);var n=[t.page.x-e.x-this.offset[0],t.page.y-e.y-this.offset[1]];if(this.options.snap)if("function"==typeof this.options.snap)n=this.options.snap(n[0],n[1]);else if(this.options.snap instanceof Array){var o=-1;n=MochiKit.Base.map(MochiKit.Base.bind(function(t){return o+=1,Math.round(t/this.options.snap[o])*this.options.snap[o]},this),n)}else n=MochiKit.Base.map(MochiKit.Base.bind(function(t){return Math.round(t/this.options.snap)*this.options.snap},this),n);var r=this.element.style;this.options.constraint&&"horizontal"!=this.options.constraint||(r.left=n[0]+"px"),this.options.constraint&&"vertical"!=this.options.constraint||(r.top=n[1]+"px"),"hidden"==r.visibility&&(r.visibility="")},stopScrolling:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null,MochiKit.DragAndDrop.Draggables._lastScrollPointer=null)},startScrolling:function(t){(t[0]||t[1])&&(this.scrollSpeed=[t[0]*this.options.scrollSpeed,t[1]*this.options.scrollSpeed],this.lastScrolled=new Date,this.scrollInterval=setInterval(MochiKit.Base.bind(this.scroll,this),10))},scroll:function(){var t=new Date,e=t-this.lastScrolled;if(this.lastScrolled=t,this.options.scroll==window){var i=this._getWindowScroll(this.options.scroll);if(this.scrollSpeed[0]||this.scrollSpeed[1]){var n=e/1e3;this.options.scroll.scrollTo(i.left+n*this.scrollSpeed[0],i.top+n*this.scrollSpeed[1])}}else this.options.scroll.scrollLeft+=this.scrollSpeed[0]*e/1e3,this.options.scroll.scrollTop+=this.scrollSpeed[1]*e/1e3;var o=MochiKit.DragAndDrop;MochiKit.Position.prepare(),o.Droppables.show(o.Draggables._lastPointer,this.element),o.Draggables.notify("drag",this),this._isScrollChild&&(o.Draggables._lastScrollPointer=o.Draggables._lastScrollPointer||o.Draggables._lastPointer,o.Draggables._lastScrollPointer.x+=this.scrollSpeed[0]*e/1e3,o.Draggables._lastScrollPointer.y+=this.scrollSpeed[1]*e/1e3,o.Draggables._lastScrollPointer.x<0&&(o.Draggables._lastScrollPointer.x=0),o.Draggables._lastScrollPointer.y<0&&(o.Draggables._lastScrollPointer.y=0),this.draw(o.Draggables._lastScrollPointer)),this.options.onchange(this)},_getWindowScroll:function(t){var e,i,n;return MochiKit.DOM.withWindow(t,function(){e=MochiKit.Style.getViewportPosition(t.document)}),n=t.innerWidth?(i=t.innerWidth,t.innerHeight):t.document.documentElement&&t.document.documentElement.clientWidth?(i=t.document.documentElement.clientWidth,t.document.documentElement.clientHeight):(i=t.document.body.offsetWidth,t.document.body.offsetHeight),{top:e.y,left:e.x,width:i,height:n}},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}},MochiKit.DragAndDrop.__new__=function(){MochiKit.Base.nameFunctions(this),this.EXPORT_TAGS={":common":this.EXPORT,":all":MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)}},MochiKit.DragAndDrop.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.DragAndDrop),MochiKit.Base._deps("Sortable",["Base","Iter","DOM","Position","DragAndDrop"]),MochiKit.Sortable.NAME="MochiKit.Sortable",MochiKit.Sortable.VERSION="1.4.2",MochiKit.Sortable.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Sortable.toString=function(){return this.__repr__()},MochiKit.Sortable.EXPORT=[],MochiKit.Sortable.EXPORT_OK=[],MochiKit.Base.update(MochiKit.Sortable,{sortables:{},_findRootElement:function(t){for(;"BODY"!=t.tagName.toUpperCase();){if(t.id&&MochiKit.Sortable.sortables[t.id])return t;t=t.parentNode}},_createElementId:function(t){if(null==t.id||""==t.id){for(var e,i=MochiKit.DOM,n=1;null!=i.getElement(e="sortable"+n);)n+=1;i.setNodeAttribute(t,"id",e)}},options:function(t){if(t=MochiKit.Sortable._findRootElement(MochiKit.DOM.getElement(t)))return MochiKit.Sortable.sortables[t.id]},destroy:function(t){var e=MochiKit.Sortable.options(t),i=MochiKit.Base,n=MochiKit.DragAndDrop;e&&(MochiKit.Signal.disconnect(e.startHandle),MochiKit.Signal.disconnect(e.endHandle),i.map(function(t){n.Droppables.remove(t)},e.droppables),i.map(function(t){t.destroy()},e.draggables),delete MochiKit.Sortable.sortables[e.element.id])},create:function(i,n){i=MochiKit.DOM.getElement(i);var t=MochiKit.Sortable;t._createElementId(i),n=MochiKit.Base.update({element:i,tag:"li",dropOnEmpty:!1,tree:!1,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:[i],handle:!1,only:!1,hoverclass:null,ghosting:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,format:/^[^_]*_(.*)$/,onChange:MochiKit.Base.noop,onUpdate:MochiKit.Base.noop,accept:null},n),t.destroy(i);var o={revert:!0,ghosting:n.ghosting,scroll:n.scroll,scrollSensitivity:n.scrollSensitivity,scrollSpeed:n.scrollSpeed,constraint:n.constraint,handle:n.handle};n.starteffect&&(o.starteffect=n.starteffect),n.reverteffect?o.reverteffect=n.reverteffect:n.ghosting&&(o.reverteffect=function(t){t.style.top=0,t.style.left=0}),n.endeffect&&(o.endeffect=n.endeffect),n.zindex&&(o.zindex=n.zindex);var r={overlap:n.overlap,containment:n.containment,hoverclass:n.hoverclass,onhover:t.onHover,tree:n.tree,accept:n.accept},e={onhover:t.onEmptyHover,overlap:n.overlap,containment:n.containment,hoverclass:n.hoverclass,accept:n.accept};MochiKit.DOM.removeEmptyTextNodes(i),n.draggables=[],n.droppables=[],(n.dropOnEmpty||n.tree)&&(new MochiKit.DragAndDrop.Droppable(i,e),n.droppables.push(i)),MochiKit.Base.map(function(t){var e=n.handle?MochiKit.DOM.getFirstElementByTagAndClassName(null,n.handle,t):t;n.draggables.push(new MochiKit.DragAndDrop.Draggable(t,MochiKit.Base.update(o,{handle:e}))),new MochiKit.DragAndDrop.Droppable(t,r),n.tree&&(t.treeNode=i),n.droppables.push(t)},t.findElements(i,n)||[]),n.tree&&MochiKit.Base.map(function(t){new MochiKit.DragAndDrop.Droppable(t,e),t.treeNode=i,n.droppables.push(t)},t.findTreeElements(i,n)||[]),(t.sortables[i.id]=n).lastValue=t.serialize(i),n.startHandle=MochiKit.Signal.connect(MochiKit.DragAndDrop.Draggables,"start",MochiKit.Base.partial(t.onStart,i)),n.endHandle=MochiKit.Signal.connect(MochiKit.DragAndDrop.Draggables,"end",MochiKit.Base.partial(t.onEnd,i))},onStart:function(t,e){var i=MochiKit.Sortable,n=i.options(t);n.lastValue=i.serialize(n.element)},onEnd:function(t,e){var i=MochiKit.Sortable;i.unmark();var n=i.options(t);n.lastValue!=i.serialize(n.element)&&n.onUpdate(n.element)},findElements:function(t,e){return MochiKit.Sortable.findChildren(t,e.only,e.tree,e.tag)},findTreeElements:function(t,e){return MochiKit.Sortable.findChildren(t,e.only,!!e.tree,e.treeTag)},findChildren:function(t,i,n,o){if(!t.hasChildNodes())return null;o=o.toUpperCase(),i=i&&MochiKit.Base.flattenArray([i]);var r=[];return MochiKit.Base.map(function(e){if(!e.tagName||e.tagName.toUpperCase()!=o||i&&!MochiKit.Iter.some(i,function(t){return MochiKit.DOM.hasElementClass(e,t)})||r.push(e),n){var t=MochiKit.Sortable.findChildren(e,i,n,o);t&&0<t.length&&(r=r.concat(t))}},t.childNodes),r},onHover:function(t,e,i){if(!MochiKit.DOM.isChildNode(e,t)){var n=MochiKit.Sortable;if(!(.33<i&&i<.66&&n.options(e).tree))if(.5<i){if(n.mark(e,"before"),e.previousSibling!=t){var o=t.parentNode;t.style.visibility="hidden",e.parentNode.insertBefore(t,e),e.parentNode!=o&&n.options(o).onChange(t),n.options(e.parentNode).onChange(t)}}else{n.mark(e,"after");var r=e.nextSibling||null;if(r!=t){o=t.parentNode;t.style.visibility="hidden",e.parentNode.insertBefore(t,r),e.parentNode!=o&&n.options(o).onChange(t),n.options(e.parentNode).onChange(t)}}}},_offsetSize:function(t,e){return"vertical"==e||"height"==e?t.offsetHeight:t.offsetWidth},onEmptyHover:function(t,e,i){var n=t.parentNode,o=MochiKit.Sortable,r=o.options(e);if(!MochiKit.DOM.isChildNode(e,t)){var s,a=o.findElements(e,{tag:r.tag,only:r.only}),l=null;if(a){var c=o._offsetSize(e,r.overlap)*(1-i);for(s=0;s<a.length;s+=1){if(!(0<=c-o._offsetSize(a[s],r.overlap))){if(0<=c-o._offsetSize(a[s],r.overlap)/2){l=s+1<a.length?a[s+1]:null;break}l=a[s];break}c-=o._offsetSize(a[s],r.overlap)}}e.insertBefore(t,l),o.options(n).onChange(t),r.onChange(t)}},unmark:function(){var t=MochiKit.Sortable._marker;t&&MochiKit.Style.hideElement(t)},mark:function(t,e){var i=MochiKit.DOM,n=MochiKit.Sortable,o=n.options(t.parentNode);if(!o||o.ghosting){n._marker||(n._marker=i.getElement("dropmarker")||document.createElement("DIV"),MochiKit.Style.hideElement(n._marker),i.addElementClass(n._marker,"dropmarker"),n._marker.style.position="absolute",document.getElementsByTagName("body").item(0).appendChild(n._marker));var r=MochiKit.Position.cumulativeOffset(t);n._marker.style.left=r.x+"px",n._marker.style.top=r.y+"px","after"==e&&("horizontal"==o.overlap?n._marker.style.left=r.x+t.clientWidth+"px":n._marker.style.top=r.y+t.clientHeight+"px"),MochiKit.Style.showElement(n._marker)}},_tree:function(t,e,i){for(var n=MochiKit.Sortable,o=n.findElements(t,e)||[],r=0;r<o.length;++r){var s=o[r].id.match(e.format);if(s){var a={id:encodeURIComponent(s?s[1]:null),element:t,parent:i,children:[],position:i.children.length,container:n._findChildrenElement(o[r],e.treeTag.toUpperCase())};a.container&&n._tree(a.container,e,a),i.children.push(a)}}return i},_findChildrenElement:function(t,e){if(t&&t.hasChildNodes){e=e.toUpperCase();for(var i=0;i<t.childNodes.length;++i)if(t.childNodes[i].tagName.toUpperCase()==e)return t.childNodes[i]}return null},tree:function(t,e){t=MochiKit.DOM.getElement(t);var i=MochiKit.Sortable.options(t);e=MochiKit.Base.update({tag:i.tag,treeTag:i.treeTag,only:i.only,name:t.id,format:i.format},e||{});var n={id:null,parent:null,children:new Array,container:t,position:0};return MochiKit.Sortable._tree(t,e,n)},setSequence:function(t,e,i){var n=MochiKit.Sortable,o=MochiKit.Base;t=MochiKit.DOM.getElement(t),i=o.update(n.options(t),i||{});var r={};o.map(function(t){var e=t.id.match(i.format);e&&(r[e[1]]=[t,t.parentNode]),t.parentNode.removeChild(t)},n.findElements(t,i)),o.map(function(t){var e=r[t];e&&(e[1].appendChild(e[0]),delete r[t])},e)},_constructIndex:function(t){for(var e="";t.id&&(e="["+t.position+"]"+e),null!=(t=t.parent););return e},sequence:function(t,e){t=MochiKit.DOM.getElement(t);var i=MochiKit.Sortable;e=MochiKit.Base.update(i.options(t),e||{});return MochiKit.Base.map(function(t){return t.id.match(e.format)?t.id.match(e.format)[1]:""},MochiKit.DOM.getElement(i.findElements(t,e)||[]))},serialize:function(t,e){t=MochiKit.DOM.getElement(t);var i=MochiKit.Sortable;e=MochiKit.Base.update(i.options(t),e||{});var n=encodeURIComponent(e.name||t.id);return e.tree?MochiKit.Base.flattenArray(MochiKit.Base.map(function(t){return[n+i._constructIndex(t)+"[id]="+encodeURIComponent(t.id)].concat(t.children.map(arguments.callee))},i.tree(t,e).children)).join("&"):MochiKit.Base.map(function(t){return n+"[]="+encodeURIComponent(t)},i.sequence(t,e)).join("&")}}),MochiKit.Sortable.Sortable=MochiKit.Sortable,MochiKit.Sortable.__new__=function(){MochiKit.Base.nameFunctions(this),this.EXPORT_TAGS={":common":this.EXPORT,":all":MochiKit.Base.concat(this.EXPORT,this.EXPORT_OK)}},MochiKit.Sortable.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Sortable),InterpreterManager=function(){bindMethods(this)},InterpreterManager.prototype.initialize=function(){connect("interpreter_text","onkeyup",this.keyUp),connect("interpreter_textarea","onkeydown",this.areaKeyDown),connect("interpreter_form","onsubmit",this.submit),getElement("interpreter_text").focus(),this.banner(),this.lines=[],this.history=[],this.currentHistory="",this.historyPos=-1,this.blockingOn=null,void 0===this.doEval&&(this.doEval=function(){return eval(arguments[0])}),window.help=this.help,this.help.NAME="type help(func) for help on a MochiKit function"},InterpreterManager.prototype.banner=function(){var t=window.navigator.userAgent,e=t.replace(/^Mozilla\/.*?\(.*?\)\s*/,"");""==e&&(e=t.replace(/^Mozilla\/4\.0 \(compatible; MS(IE .*?);.*$/,"$1")),appendChildNodes("interpreter_output",SPAN({class:"banner"},"MochiKit v"+MochiKit.Base.VERSION+" ["+e+"]",BR(),"Type your expression in the input box below and press return, or see the notes below for more information.",BR()),BR())},InterpreterManager.prototype.submit=function(t){if(this.blockingOn){try{this.blockingOn.cancel()}catch(t){this.showError(t)}this.blockingOn=null}this.doSubmit(),this.doScroll(),t.stop()},InterpreterManager.prototype.help=function(a){if(a&&a.NAME&&(a=a.NAME),"string"==typeof a&&0!=a.length){var t=a.split("."),e=t.splice(0,2),l=t.join("."),c="../../doc/html/"+e.join("/")+".html",i=doXHR(c,{mimeType:"text/xml"});i.addCallback(function(t){for(var e=getElementsByTagAndClassName("a","mochidef",t.responseXML),i="#fn-"+l.toLowerCase(),n=0;n<e.length;n++){var o=e[n],r=o.href,s=r.indexOf("#");if(-1!=s&&r.substring(s)==i)return void writeln(A({href:c+i,target:"_blank"},scrapeText(o)))}writeln("documentation for "+a+" not found")}),blockOn(i)}else writeln("help(func) on any MochiKit function for help")},InterpreterManager.prototype.doScroll=function(){var t=getElement("interpreter_output").lastChild;if(void 0!==t&&null!=t){var e=getElement("interpreter_area");e.offsetHeight>e.scrollHeight?e.scrollTop=0:e.scrollTop=e.scrollHeight}},InterpreterManager.prototype.moveHistory=function(t){if(0!=t&&0!=this.history.length){var e=getElement("interpreter_text");if(-1==this.historyPos){if(this.currentHistory=e.value,0<t)return;return this.historyPos=this.history.length-1,void(e.value=this.history[this.historyPos])}if(!(0==this.historyPos&&t<0)){if(this.historyPos==this.history.length-1&&0<t)return this.historyPos=-1,void(e.value=this.currentHistory);this.historyPos+=t,e.value=this.history[this.historyPos]}}},InterpreterManager.prototype.runMultipleLines=function(t){var e=rstrip(t).replace("\r\n","\n").split(/\n/);appendChildNodes("interpreter_output",SPAN({class:"code"},">>> ",izip(e,imap(BR,cycle([null]))))),this.runCode(t)},InterpreterManager.prototype.areaKeyDown=function(t){var e=t.modifier(),i=e.alt||e.ctrl||e.meta;if("KEY_ENTER"==t.key().string&&i){var n=getElement("interpreter_textarea"),o=n.value;n.value="",this.runMultipleLines(o),t.stop()}},InterpreterManager.prototype.keyUp=function(t){var e=t.key();if(!t.modifier().any){switch(e.string){case"KEY_ARROW_UP":this.moveHistory(-1);break;case"KEY_ARROW_DOWN":this.moveHistory(1);break;default:return}t.stop()}},InterpreterManager.prototype.blockOn=function(e){var i=SPAN({class:"banner"},"blocking on "+repr(e)+"...");this.blockingOn=e,appendChildNodes("interpreter_output",i),this.doScroll(),e.addBoth(function(t){if(swapDOM(i),this.blockingOn=null,!(t instanceof CancelledError))return t;window.writeln(SPAN({class:"error"},repr(e)+" cancelled!"))}),e.addCallbacks(this.showResult,this.showError)},InterpreterManager.prototype.showError=function(t){"object"!=typeof t&&(t=new Error(t)),appendChildNodes("interpreter_output",SPAN({class:"error"},"Error:"),TABLE({class:"error"},THEAD({class:"invisible"},TD({colspan:2})),TFOOT({class:"invisible"},TD({colspan:2})),TBODY(null,map(function(t){var e=t[1];if("function"!=typeof e)return"object"==typeof e&&(e=repr(e)),TR(null,TD({class:"error"},t[0]),TD({class:"data"},e))},sorted(items(t)))))),window.last_exc=t,this.doScroll()},EvalFunctions={evalWith:function(){with(arguments[1]||window)return eval(arguments[0])},evalCall:function(){return eval.call(arguments[1]||window,arguments[0])},choose:function(){var t={__test__:this};try{if(this.evalWith("return __test__",t)===this)return this.evalWith}catch(t){}try{if(this.evalCall("return __test__",t)===this)return this.evalCall}catch(t){}}},InterpreterManager.prototype.doEval=EvalFunctions.choose(),InterpreterManager.prototype.doSubmit=function(){var t=getElement("interpreter_text"),e=t.value;t.value="";var i=!1;if(2<=e.length&&e.lastIndexOf("//")==e.length-2&&(i=!0,e=e.substr(0,e.length-2)),appendChildNodes("interpreter_output",SPAN({class:"code"},">>> ",e),BR()),this.lines.push(e),this.history.push(e),this.historyPos=-1,this.currentHistory="",!i){var n=this.lines.join("\n");this.lines=[],this.runCode(n)}},InterpreterManager.prototype.runCode=function(t){var e;try{e=this.doEval(t)}catch(t){return void this.showError(t)}this.showResult(e)},InterpreterManager.prototype.showResult=function(t){void 0!==t&&(window._=t),void 0!==t&&(appendChildNodes("interpreter_output",SPAN({class:"data"},repr(t)),BR()),this.doScroll())},window.writeln=function(){appendChildNodes("interpreter_output",SPAN({class:"data"},arguments),BR()),interpreterManager.doScroll()},window.clear=function(){replaceChildNodes("interpreter_output"),getElement("interpreter_area").scrollTop=0},window.blockOn=function(t){if(!(t instanceof Deferred))throw new TypeError(repr(t)+" is not a Deferred!");interpreterManager.blockOn(t)},window.dir=function(t){return sorted(keys(t))},window.inspect=function(t){if("function"!=typeof(window._=t)&&"object"!=typeof t||null==t)window.writeln(repr(t));else{var e=items(t);0!=e.length?window.writeln(TABLE({border:"1"},THEAD({class:"invisible"},TR(null,TD(),TD())),TFOOT({class:"invisible"},TR(null,TD(),TD())),TBODY(null,map(function(t){return TR(null,TD(null,A({href:"#",onclick:function(){try{window.inspect(t[1])}catch(t){interpreterManager.showError(t)}return!1}},t[0])),TD(null,repr(t[1])))},e)))):window.writeln(repr(t))}},interpreterManager=new InterpreterManager,addLoadEvent(interpreterManager.initialize),addLoadEvent(function(){for(var t=getElementsByTagAndClassName("A","view-source"),e=0;e<t.length;e++){var i=t[e],n=i.href.split(/\//).pop();i.target="_blank",i.href="../view-source/view-source.html#interpreter/"+n}});